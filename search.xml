<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[数据仓库（一）：认识数据仓库]]></title>
      <url>/2018/09/22/dw-begin/</url>
      <content type="html"><![CDATA[<p><img src="http://omzy9bjcy.bkt.clouddn.com/%E6%9C%AA%E6%A0%87%E9%A2%98-10.png" alt=""></p>
<p>刚接触数据仓库是在我的第一份实习工作——数据中心数据管理系统开发，它是一个B/S架构的应用，与一般的项目不同的是，系统是以数据仓库来进行数据存取的，这是我第一次听说数仓这个词，感觉它庞大而且神秘，不知道从何入手，对数据仓库有一种敬畏之心，后来经过慢慢的学习和使用，发现其实它在应用开发中的使用方法跟传统关系数据库没什么区别，无非就是普通的SQL查询以及JDBC连接。所以数仓的使用不是本文的重点，我们主要来认识一下数据仓库到底是什么。<br><a id="more"></a></p>
<blockquote>
<p><strong>文章要点</strong></p>
<ul>
<li>什么是数据仓库</li>
<li>数据中心架构</li>
<li>数据仓库内部架构</li>
</ul>
</blockquote>
<hr>
<h1 id="什么是数据仓库"><a href="#什么是数据仓库" class="headerlink" title="什么是数据仓库"></a>什么是数据仓库</h1><p>数据仓库（Data Warehouse）是面向主题的、集成的、稳定的、随时间变化的数据集合，用来支持运营管理中的决策制定，为用户提供各种手段从数据中获取有用的信息。它的根本任务是对大量的业务数据进行归纳整理以及重组，然后提供给决策管理人员。</p>
<p>数据仓库是依赖于数据库进行数据存储和管理的，所以数据库是整个数据仓库的核心。相对于传统数据库来说数仓的数据库最突出的特点是对海量数据的支持和快速的检索技术，最具代表性的是Teradata公司的Teradata数据库。数据仓库平台即数据库和其它各种软件工具整合的一套数据仓库软件。</p>
<hr>
<h1 id="数据中心架构"><a href="#数据中心架构" class="headerlink" title="数据中心架构"></a>数据中心架构</h1><p>数据中心的简化架构如下图：</p>
<p><img src="http://omzy9bjcy.bkt.clouddn.com/%E6%97%A0%E6%A0%87%E9%A2%98.png" alt="数据中心架构"></p>
<style>table th:last-of-type { width: 400px;}</style>

<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>业务系统</td>
<td>数据仓库的数据来源系统，提供各种所需的业务系统数据，如清算系统、票务系统等业务数据</td>
</tr>
<tr>
<td>数据加载</td>
<td>通过FTP文件传输或者数据库连接等方式，从业务系统中抽取数据统一存放，并提供给下游应用进行访问</td>
</tr>
<tr>
<td>数据仓库</td>
<td>数据加载到数据仓库后，通过预先定义的<strong>数据模型</strong>处理数据，并进行存放汇总，包含临时数据、核心模型数据、集市数据和元数据等，提供给下游应用使用</td>
</tr>
<tr>
<td>访问代理</td>
<td>为下游应用对数据仓库的访问提供负载均衡、灾备系统切换等服务</td>
</tr>
<tr>
<td>数据访问</td>
<td>各下游应用如统计分析、运营评估、信息管理等应用平台，对数据仓库的数据进行查询获取，可通过导出数据文件或数据库连接等方式进行访问</td>
</tr>
<tr>
<td>ETL管理</td>
<td>对数据抽取转换加载（ETL）的管理，它是构建数据仓库的重要一环，包括总体控制、作业管理、上下游依赖管理、错误管理、调度监控等所有ETL相关内容的管理</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="数据仓库内部架构"><a href="#数据仓库内部架构" class="headerlink" title="数据仓库内部架构"></a>数据仓库内部架构</h1><p>数据仓库的真正关键是数据的存储和管理。数据仓库的组织管理方式决定了它有别于传统数据库，其中一个重要的特点是对数据的分区管理，ETL会根据预先定义的数据模型以及各种数据的用途，来对数仓中的数据进行划分，它的内部架构一般是这样的：</p>
<p><img src="http://omzy9bjcy.bkt.clouddn.com/%E6%97%A0%E6%A0%87%E9%A2%982.png" alt="数据仓库内部架构"></p>
<table>
<thead>
<tr>
<th>数据区</th>
<th>数据区名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>STG</td>
<td>临时区</td>
<td>存放从源系统抽取的原始数据</td>
</tr>
<tr>
<td>ODS</td>
<td>操作镜像区</td>
<td>完成原始数据的增量累全量工作，保留较短历史数据</td>
</tr>
<tr>
<td>PDM</td>
<td>物理数据模型区</td>
<td>基于数据模型设计，存放规范化数据，保留较长历史数据</td>
</tr>
<tr>
<td>SUM</td>
<td>基础数据衍生区</td>
<td>存放预统计、预汇总数据，提炼出对数据仓库具有共性的数据访问、统计需求，从而构建出的一个面向支持应用系统、数据分析与数据挖掘提供共享的数据访问服务的公共数据区</td>
</tr>
<tr>
<td>APP</td>
<td>应用集市区</td>
<td>按照应用系统分别建立，存放为某类特定的业务系统服务的数据集合，根据业务需要的重度汇总数据</td>
</tr>
</tbody>
</table>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2018/09/22/dw-begin/。">https://zkhdev.github.io/2018/09/22/dw-begin/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 大数据 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> 数据仓库 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[vue-router 组件复用问题]]></title>
      <url>/2018/01/21/vuejs-component-reuse/</url>
      <content type="html"><![CDATA[<p>组件系统是Vue的一个重要组成部分，它可以将一个复杂的页面抽象分解成许多小型、独立、可复用的组件，通过组合组件来组成应用程序，结合<code>vue-router</code>的路由功能将各个组件映射到相应的路由上，通过路由的变化来告诉Vue要在哪里渲染他们，实现各个组件、各个页面之间的跳转导航。<br><a id="more"></a></p>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>使用<code>vue-router</code>切换路由时会触发组件树的更新，根据定义的路由渲染一个新的组件树，大致的切换过程是这样的：</p>
<ul>
<li>停用并移除不需要的组件</li>
<li>验证切换的可行性</li>
<li>复用没有进行更新的组件</li>
<li>启用并激活新的组件</li>
</ul>
<blockquote>
<p>具体路由切换控制流程请参考官方文档：<a href="https://github.com/vuejs/vue-router/blob/1.0/docs/zh-cn/pipeline/README.md" target="_blank" rel="noopener">切换控制流水线</a></p>
</blockquote>
<p><strong>那<code>vue-router</code>是怎么判断某一个组件可以复用的呢？</strong> 我们看一下下面这条路由配置：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path: <span class="string">'post/:postId'</span>,</span><br><span class="line">    name: <span class="string">'post'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">require</span>([<span class="string">'./components/Post.vue'</span>],resolve)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这是通过文章ID加载对应文章页面的路由，第一次访问时，<code>Post.vue</code>这个组件会被渲染到组件树中，mounted安装组件时通过文章ID获取文章内容展示到页面上，当我们访问另一篇文章时，路由参数<code>:postId</code>发生改变，按照我们的预期应该会展示新文章的内容，但是事与愿违。</p>
<p>我们看到的还是之前的文章，虽然路由参数已发生更改，但是<code>vue-router</code>会以为你访问的是<code>Post.vue</code>这个组件，由于之前已经渲染过该组件，所以会直接复用之前的组件，并且<strong>不会</strong>执行组件中的任何操作包括<code>mounted</code>之类的生命周期函数。</p>
<p>所以我们最终看到的还是原来组件的内容。</p>
<p><strong>那要怎么才能实现我们期望的效果呢？下面介绍一种有效的解决方法</strong></p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>我们可以使用<code>watch</code>侦听器来监听路由的变化情况，根据路由参数的变化来响应相应的数据，具体实现过程是这样的：</p>
<h2 id="定义数据获取方法"><a href="#定义数据获取方法" class="headerlink" title="定义数据获取方法"></a>定义数据获取方法</h2><p>首先定义一个获取文章的方法，根据文章ID从后台获取对应的文章信息。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    getPost(postId) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$http.get(<span class="string">`/post/get_post/<span class="subst">$&#123;postId&#125;</span>`</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(response.data.code === <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">this</span>.post = response.data.post;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="监听路由"><a href="#监听路由" class="headerlink" title="监听路由"></a>监听路由</h2><p>接着是在路由切换的时候判断目标组件是否是<code>Post.vue</code>组件，这里可以根据定义的路由名称<code>name</code>实现，如果是，我们就可以从路由信息中获取目标文章ID来更新组件内容。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">    <span class="string">'$route'</span> (to, <span class="keyword">from</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(to.name === <span class="string">'post'</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.getPost(to.params.postId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="组件初始化"><a href="#组件初始化" class="headerlink" title="组件初始化"></a>组件初始化</h2><p>这里需要注意的是，<strong>当组件首次被挂载到组件树上时，对路由的监听是无效的</strong>，这时我们需要在生命周期钩子<code>mounted</code>对组件进行初始化工作：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">    <span class="keyword">this</span>.getPost(<span class="keyword">this</span>.$route.params.postId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>通过上面的方法就可以实现组件内容随路由参数的变化而更新了，有效解决了<code>vue-router</code>组件复用导致路由参数失效的问题。</p>
<blockquote>
<p>本文属<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2018/01/21/vuejs-component-reuse/">https://zkhdev.github.io/2018/01/21/vuejs-component-reuse/</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vuejs之开发环境搭建]]></title>
      <url>/2018/01/06/vuejs-begin/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-3f8686d8901e07ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>Vue.js是目前很火的一个前端框架，采用MVVM模式设计，它是以数据驱动和组件化的思想构建的。相比于Angular.js，Vue.js提供了更加简洁、更易于理解的API，使得我们能够快速地上手并使用，特别适合单页应用的开发。<br><a id="more"></a><br>Vue.js是数据驱动的，它通过一些特殊的语法，将DOM和数据绑定起来，无需手动操作DOM。一旦创建了绑定，DOM将和数据保持同步，每当变更了数据，DOM也会相应地更新。</p>
<h1 id="安装-vue-cli"><a href="#安装-vue-cli" class="headerlink" title="安装 vue-cli"></a>安装 vue-cli</h1><p>Vue 提供一个官方命令行工具<code>vue-cli</code>，可用于快速搭建大型单页应用。由于vue-cli是基于nodejs进行工作的，所以安装之前需要确保你的电脑已安装nodejs环境，完成后就可以安装vue-cli工具了：<code>npm i vue-cli -g</code></p>
<h1 id="快速构建vue应用"><a href="#快速构建vue应用" class="headerlink" title="快速构建vue应用"></a>快速构建vue应用</h1><p>工具安装好后使用命令<code>vue init webpack-simple [应用名称]</code>即可在当前工作目录下创建一个最基本的vue应用，创建过程中会进行相关应用信息的配置，安装结果如图：<br><img src="http://upload-images.jianshu.io/upload_images/5266042-3172f7ba857ea4c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="安装结果"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-7f137919c6d3b998.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="应用结构"></p>
<p>这样一个最基本的vue应用就搭建好了，我们按照提示的命令安装依赖模块并启动，完成后浏览器就会弹出应用主页了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd myvue</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-9793c756340f3869.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="vuejs应用主页"></p>
<blockquote>
<p>安装依赖的过程可能比较慢，可以通过安装淘宝镜像解决：<code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code>，之后安装依赖时使用<code>cnpm</code>替代<code>npm</code>即可，如：<code>cnpm install</code></p>
</blockquote>
<h1 id="安装-vue-devtools-调试工具"><a href="#安装-vue-devtools-调试工具" class="headerlink" title="安装 vue-devtools 调试工具"></a>安装 vue-devtools 调试工具</h1><p>vue-devtools是一款基于浏览器的vuejs应用的调试工具，支持Chrome、Firefox、Safari浏览器，用于调试vue应用，可以极大地提高我们的调试效率。</p>
<p>这里以Chrome浏览器为例，介绍vue-devtools的两种安装方式：</p>
<h2 id="直接从chrome商店安装"><a href="#直接从chrome商店安装" class="headerlink" title="直接从chrome商店安装"></a>直接从chrome商店安装</h2><p><a href="https://chrome.google.com/webstore/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd" target="_blank" rel="noopener">Get the Chrome Extension</a><br>这种最简单的安装方式，但前提你懂的 —- 翻墙</p>
<h2 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h2><p>这种方式稍微麻烦一点，首先我们要将vue-devtools的github项目clone到本地<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/vuejs/vue-devtools.git</span><br></pre></td></tr></table></figure></p>
<p>然后安装相关依赖模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure></p>
<p>接着编译项目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure></p>
<p>最后安装到Chrome浏览器中，打开浏览器的扩展程序页面<br><img src="http://upload-images.jianshu.io/upload_images/5266042-34c1493a91fa7be0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="扩展程序"></p>
<p>开启“开发者模式”，点击“加载已解压的扩展程序…”，选择vue-devtools\shells\chrome文件夹即可完成安装</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-ceb7d2071a2309cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="安装vue-devtools"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>我们只需在vue应用页面点击<code>F12</code>快捷键，即可看见vue-devtools工具了<br><img src="http://upload-images.jianshu.io/upload_images/5266042-5ed520833e36f267.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="vue-devtools"></p>
<h1 id="安装-postcss-loader"><a href="#安装-postcss-loader" class="headerlink" title="安装 postcss-loader"></a>安装 postcss-loader</h1><p>使用css来构建页面的样式时，为了考虑浏览器兼容问题，我们会使用兼容性前缀，比较繁琐，通过<code>postcss</code>就可以在编译的时候自动补全css代码的兼容性前缀了，不需要我们手动添加</p>
<p>首先我们需要安装<code>postcss-loader</code>和<code>autoprefixer</code>模块：<code>npm install postcss-loader autoprefixer -S</code>，接着打开<code>webpack.config.js</code>配置文件，修改以下地方：<br><img src="http://upload-images.jianshu.io/upload_images/5266042-17bced82058bc0ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="修改webpack.config.js"></p>
<p>然后我们需要单独创建<code>postcss.config.js</code>配置文件，放在应用根目录下，文件内容：<br><img src="http://upload-images.jianshu.io/upload_images/5266042-43f8c67c7ad69fe7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="postcss.config.js"><br>好了，我们看一下配置前后的效果吧</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-ddff566fbdabe4cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="css源码"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-d0f2adceecec2ea1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="postcss配置前"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-0d3862228efd1403.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="postcss配置后"></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2018/01/06/vuejs-begin/。">https://zkhdev.github.io/2018/01/06/vuejs-begin/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
            <tag> vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java开发小技巧（四）：配置文件敏感信息处理]]></title>
      <url>/2017/12/22/java-dev4/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-e9660555161d2048.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>AES（高级加密标准）是美国联邦政府采用的一种区块加密标准，其替代原先的DES加密算法，成为对称密钥加密中最流行的算法之一。<br><a id="more"></a><br>不知道在<a href="http://www.jianshu.com/p/3fa98dd52520" target="_blank" rel="noopener">上一篇文章</a>中你有没有发现，<code>jdbc.properties</code>中的数据库密码配置是这样写的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc.password=5EF28C5A9A0CE86C2D231A526ED5B388</span><br></pre></td></tr></table></figure></p>
<p>其实这不是真正的密码，而是经过AES加密的。</p>
<h1 id="AES的Java实现"><a href="#AES的Java实现" class="headerlink" title="AES的Java实现"></a>AES的Java实现</h1><p>AES加密解密的实现就不具体介绍了，这里直接给出源码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.project.monitor.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.*;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AESEncryption</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String password = <span class="string">"Password"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AESEncryption</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AESEncryption</span><span class="params">(String password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content 加密内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">encrypt</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            KeyGenerator kgen = KeyGenerator.getInstance(<span class="string">"AES"</span>);</span><br><span class="line">            kgen.init(<span class="number">128</span>, <span class="keyword">new</span> SecureRandom(password.getBytes()));</span><br><span class="line">            SecretKey secretKey = kgen.generateKey();</span><br><span class="line">            <span class="keyword">byte</span>[] enCodeFormat = secretKey.getEncoded();</span><br><span class="line">            SecretKeySpec key = <span class="keyword">new</span> SecretKeySpec(enCodeFormat, <span class="string">"AES"</span>);</span><br><span class="line">            Cipher cipher = Cipher.getInstance(<span class="string">"AES"</span>);<span class="comment">// 创建密码器</span></span><br><span class="line">            <span class="keyword">byte</span>[] byteContent = content.getBytes(<span class="string">"utf-8"</span>);</span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, key);<span class="comment">// 初始化</span></span><br><span class="line">            <span class="keyword">byte</span>[] result = cipher.doFinal(byteContent);</span><br><span class="line">            <span class="keyword">return</span> parseByte2HexStr(result); <span class="comment">// 加密</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchPaddingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvalidKeyException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (BadPaddingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**解密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content  解密内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">decrypt</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            KeyGenerator kgen = KeyGenerator.getInstance(<span class="string">"AES"</span>);</span><br><span class="line">            kgen.init(<span class="number">128</span>, <span class="keyword">new</span> SecureRandom(password.getBytes()));</span><br><span class="line">            SecretKey secretKey = kgen.generateKey();</span><br><span class="line">            <span class="keyword">byte</span>[] enCodeFormat = secretKey.getEncoded();</span><br><span class="line">            SecretKeySpec key = <span class="keyword">new</span> SecretKeySpec(enCodeFormat, <span class="string">"AES"</span>);</span><br><span class="line">            Cipher cipher = Cipher.getInstance(<span class="string">"AES"</span>);<span class="comment">// 创建密码器</span></span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, key);<span class="comment">// 初始化</span></span><br><span class="line">            <span class="keyword">byte</span>[] result = cipher.doFinal(parseHexStr2Byte(content));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(result); <span class="comment">// 解密</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchPaddingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvalidKeyException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (BadPaddingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将二进制转换成16进制</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> buf</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">parseByte2HexStr</span><span class="params">(<span class="keyword">byte</span> buf[])</span> </span>&#123;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; buf.length; i++) &#123;</span><br><span class="line">            String hex = Integer.toHexString(buf[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">            <span class="keyword">if</span> (hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                hex = <span class="string">'0'</span> + hex;</span><br><span class="line">            &#125;</span><br><span class="line">            sb.append(hex.toUpperCase());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将16进制转换为二进制</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> hexStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] parseHexStr2Byte(String hexStr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hexStr.length() &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] result = <span class="keyword">new</span> <span class="keyword">byte</span>[hexStr.length()/<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i&lt; hexStr.length()/<span class="number">2</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> high = Integer.parseInt(hexStr.substring(i*<span class="number">2</span>, i*<span class="number">2</span>+<span class="number">1</span>), <span class="number">16</span>);</span><br><span class="line">            <span class="keyword">int</span> low = Integer.parseInt(hexStr.substring(i*<span class="number">2</span>+<span class="number">1</span>, i*<span class="number">2</span>+<span class="number">2</span>), <span class="number">16</span>);</span><br><span class="line">            result[i] = (<span class="keyword">byte</span>) (high * <span class="number">16</span> + low);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="解密配置文件"><a href="#解密配置文件" class="headerlink" title="解密配置文件"></a>解密配置文件</h1><p>既然配置文件部分内容已经进行了加密处理，那我们在填充上下文的占位符时就要对其进行解密，获得真正的密码，还记得之前我们在加载配置文件的时候使用的类<code>PropertyPlaceholderConfigurer</code>吗？我们可以通过对它的<code>resolvePlaceholder</code>方法进行重写来实现。</p>
<h2 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h2><p>首先创建一个继承自<code>PropertyPlaceholderConfigurer</code>的类<code>EncryptPropertyPlaceholderConfigurer</code>，然后重写它的方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.project.monitor.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 解密配置文件敏感内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EncryptPropertyPlaceholderConfigurer</span> <span class="keyword">extends</span> <span class="title">PropertyPlaceholderConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">resolvePlaceholder</span><span class="params">(String placeholder, Properties props)</span> </span>&#123;</span><br><span class="line">        String result = props.getProperty(placeholder);</span><br><span class="line">        <span class="keyword">if</span>(placeholder.endsWith(<span class="string">"jdbc.password"</span>))&#123;</span><br><span class="line">            AESEncryption aes = <span class="keyword">new</span> AESEncryption();</span><br><span class="line">            String decrypt = aes.decrypt(result);</span><br><span class="line">            result = decrypt == <span class="keyword">null</span> ? result : decrypt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>接着在spring上下文中将原来的bean<code>org.springframework.beans.factory.config.PropertyPlaceholderConfigurer</code>修改为我们创建的类即可：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.demo.project.monitor.util.EncryptPropertyPlaceholderConfigurer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"locations"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:jdbc.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"ignoreResourceNotFound"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这样spring在填充占位符的时候就会进行判断，对加密后的敏感信息进行解密处理，得到真实的内容。</p>
<p>文章项目源码已发布到Github：<a href="https://github.com/ZKHDEV/MultDependPjo" target="_blank" rel="noopener">https://github.com/ZKHDEV/MultDependPjo</a></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/12/22/java-dev4/。">https://zkhdev.github.io/2017/12/22/java-dev4/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java开发小技巧（三）：Maven多工程依赖项目]]></title>
      <url>/2017/12/22/java-dev3/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-26f2758e0f40a631.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Maven多工程依赖项目开发流程"></p>
<p>本篇文章基于<a href="https://zkhdev.github.io/2017/12/21/java-dev2/">Java开发小技巧（二）：自定义Maven依赖</a>中创建的父工程<code>project-monitor</code>实现，运用我们自定义的依赖包进行多工程依赖项目的开发。<br><a id="more"></a><br>下面以多可执行Jar包项目的开发为例，进行Maven多工程依赖项目开发的讲解。</p>
<h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p>首先来看一下封面图，我们要实现的效果是：<br>1.多个项目共享一个项目的类和方法等通用内容<br>2.每个子项目单独导入所需依赖，以及各自填充父项目配置文件中的占位符<br>3.子项目按指定目录结构进行打包<br>4.所有子项目集成打包到一个统一的目录，共享依赖包和配置文件等内容<br>5.打包后目录结构：</p>
<ul>
<li>bin：存放脚本文件，用来设置环境变量，执行相应的jar包</li>
<li>lib：依赖、项目jar包</li>
<li>etc：配置文件</li>
<li>……</li>
</ul>
<p>好啦，目标明确的，接下来要进行具体开发实现了</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="打包配置"><a href="#打包配置" class="headerlink" title="打包配置"></a>打包配置</h2><p>在上一篇文章中已经创建好了一个自定义的Maven依赖，相当于一个父项目，接下来我们新建一个子项目，命名为<code>project-one</code>，<code>pom.xml</code>文件与父项目基本相同，所有依赖包都必须单独引入，不同的是多了对父项目的依赖：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project-monitor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>以及Maven插件<code>maven-assembly-plugin</code>的引入，用来实现依赖的打包以及打包后的目录结构：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appendAssemblyId</span>&gt;</span>false<span class="tag">&lt;/<span class="name">appendAssemblyId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">descriptors</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">descriptor</span>&gt;</span>package.xml<span class="tag">&lt;/<span class="name">descriptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">descriptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>make-assembly<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>single<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>目录结构配置位于项目根目录下<code>package.xml</code>配置文件中：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">assembly</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0http://maven.apache.org/xsd/assembly-1.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>package<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">formats</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">format</span>&gt;</span>zip<span class="tag">&lt;/<span class="name">format</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">formats</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">includeBaseDirectory</span>&gt;</span>true<span class="tag">&lt;/<span class="name">includeBaseDirectory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">fileSets</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fileSet</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>etc<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">fileSet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">fileSets</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencySets</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencySet</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>lib<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencySet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencySets</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">assembly</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>以上就实现了项目打包的配置工作，实现流程图中最后的项目结构，打包结果为zip文件</p>
<h2 id="填充配置文件占位符"><a href="#填充配置文件占位符" class="headerlink" title="填充配置文件占位符"></a>填充配置文件占位符</h2><p>之前我们在父项目的spring上下文中定义了一个数据源bean，配置信息使用了占位符填充，所以如果我们想要使用这个bean，就需要替换其中的占位符信息，要怎么做呢？<br>首先当然是创建配置文件了，在项目中创建<code>jdbc.properties</code>JDBC配置文件，如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localdb:3306/test?characterEncoding=utf8&amp;useSSL=true&amp;serverTimezone=UTC</span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=5EF28C5A9A0CE86C2D231A526ED5B388</span><br></pre></td></tr></table></figure></p>
<p>然后我们需要借助<code>PropertyPlaceholderConfigurer</code>这个类来实现，在项目spring上下文中定义bean：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"locations"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:jdbc.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"ignoreResourceNotFound"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Bingo，占位符修改完毕，别忘了引入父项目的上下文，毕竟我们要填充占位符的bean是在父项目中的：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"classpath*:project-monitor.xml"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="测试Demo"><a href="#测试Demo" class="headerlink" title="测试Demo"></a>测试Demo</h2><p>好了，接下来来测试项目的可行性，主要实现使用父项目定义的数据源来对MySql进行查询。<br>先创建一个<code>DemoService</code>类，内容如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.project.one.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = Logger.getLogger(DemoService.class);</span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">queryDb</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">        ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = dataSource.getConnection();</span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line">            rs = stmt.executeQuery(<span class="string">"select * from movie limit 1"</span>);</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                logger.info(String.format(<span class="string">"Movie[Id=%d,Title=%s,Director=%s,Genre=%s,Language=%s]"</span>,</span><br><span class="line">                        rs.getInt(<span class="number">1</span>),</span><br><span class="line">                        rs.getString(<span class="number">2</span>),</span><br><span class="line">                        rs.getString(<span class="number">3</span>),</span><br><span class="line">                        rs.getString(<span class="number">4</span>),</span><br><span class="line">                        rs.getString(<span class="number">5</span>)</span><br><span class="line">                        ));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(rs != <span class="keyword">null</span>)&#123;</span><br><span class="line">                    rs.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)&#123;</span><br><span class="line">                    stmt.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">                    conn.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSource</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataSource = dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在上下文中为其注入dataSource定义：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demoService"</span> <span class="attr">class</span>=<span class="string">"com.demo.project.one.service.DemoService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>别忘了添加<code>log4j.properties</code>配置文件，这里就不贴出文件内容了。<br>OK，新建一个入口类来执行<code>DemoService</code>的测试吧：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.project.one;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.demo.project.one.service.DemoService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ConfigurableApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        ConfigurableApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"/project-one.xml"</span>);</span><br><span class="line">        DemoService demoService = (DemoService)context.getBean(<span class="string">"demoService"</span>);</span><br><span class="line">        demoService.queryDb();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最终的项目结构如图<br><img src="http://upload-images.jianshu.io/upload_images/5266042-716cd2dd327c8992.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="项目结构"></p>
<h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><p>一切准备就绪，轮到项目打包了，在项目根目录执行以下Maven命令即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure></p>
<p>执行完成后你会发现<code>target</code>目录的结构如图所示<br><img src="http://upload-images.jianshu.io/upload_images/5266042-db36dfa3a95f4a95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="target目录结构"><br>project-one.zip就是我们要的打包结果，解压后你会发现，依赖包和配置文件已经放在了各自的目录下<br><img src="http://upload-images.jianshu.io/upload_images/5266042-c752038e91a13183.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="zip包目录结构"></p>
<h2 id="执行文件"><a href="#执行文件" class="headerlink" title="执行文件"></a>执行文件</h2><p>项目开发完成，接下来就是执行程序了，以Windows平台下为例，首先创建<code>bin</code>目录，目录中创建批处理文件<code>setenv.bat</code>、<code>project-one.bat</code><br>因为jar包与配置文件的分离，所以我们需要指定执行jar包时的<code>classpath</code>，批处理文件内容如下：</p>
<h3 id="setenv-bat"><a href="#setenv-bat" class="headerlink" title="setenv.bat"></a>setenv.bat</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">set SRC_DIR=%cd%</span><br><span class="line"></span><br><span class="line">cd %~dp0</span><br><span class="line">cd ..</span><br><span class="line">set MAIN_HOME=%cd%</span><br><span class="line"></span><br><span class="line">cd %SRC_DIR%</span><br><span class="line"></span><br><span class="line">set BIN_HOME=%MAIN_HOME%\bin</span><br><span class="line">set ETC_HOME=%MAIN_HOME%\etc</span><br><span class="line">set LIB_HOME=%MAIN_HOME%\lib</span><br><span class="line">set CLASSPATH=%ETC_HOME%;%JAVA_HOME%\lib\tools.jar</span><br><span class="line"></span><br><span class="line">for %%i in (%LIB_HOME%\*.jar) do set CLASSPATH=!CLASSPATH!;%%i</span><br></pre></td></tr></table></figure>
<h3 id="project-one-bat"><a href="#project-one-bat" class="headerlink" title="project-one.bat"></a>project-one.bat</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">@setlocal enableextensions enabledelayedexpansion</span><br><span class="line">call setenv.bat</span><br><span class="line"></span><br><span class="line">chcp 65001</span><br><span class="line">java -cp %CLASSPATH% com.demo.project.one.Application</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<p>bat文件的内容就不详细解释，有兴趣可以百度了解一下，主要是为了拼接出完整的<code>CLASSPATH</code>，执行<code>project-one-0.0.1.jar</code>可执行jar包</p>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>点击<code>project-one.bat</code>运行程序<br><img src="http://upload-images.jianshu.io/upload_images/5266042-b807746111ff1cdd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="运行结果"></p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>项目终于开发演示完毕，这里只是创建一个打造可执行jar包的子项目作为例子，你还可以创建多个子项目，最后打包的时候合并相同的依赖和配置文件，然后在<code>bin</code>中创建相应项目的执行文件即可，各个子项目之间也可进行相互依赖。<br>以上开发技巧不仅适用于可执行jar包的开发，同样适用于WEB项目的开发，具体还是由项目需求决定。</p>
<p>文章项目源码已发布到Github：<a href="https://github.com/ZKHDEV/MultDependPjo" target="_blank" rel="noopener">https://github.com/ZKHDEV/MultDependPjo</a></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/12/22/java_dev3/。">https://zkhdev.github.io/2017/12/22/java_dev3/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> maven </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java开发小技巧（二）：自定义Maven依赖]]></title>
      <url>/2017/12/21/java-dev2/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-346b93b942ca64bf.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>我们在项目开发中经常会将一些通用的类、方法等内容进行打包，打造成我们自己的开发工具包，作为各个项目的依赖来使用。<br><a id="more"></a></p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>一般的做法是将项目导出成Jar包，然后在其它项目中将其导入，看起来很轻松，但是存在一个问题，如果你修改了Jar包的内容，岂不是要每个项目都重新导入，这显然是一种很不智能的做法。</p>
<p>那我们要怎样避免这种“牵一发而动全身”的效果呢？这里给大家介绍一种灵活的解决方法。</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><h2 id="自定义Maven依赖"><a href="#自定义Maven依赖" class="headerlink" title="自定义Maven依赖"></a>自定义Maven依赖</h2><p>Maven是一个项目管理工具，其中一个重要的组成部分就是依赖管理系统，用来解决项目的各种依赖，与传统的导Jar包方式相比，Maven能按照你定义的依赖描述来自动导入Maven本地或远程仓库中各种依赖包，不需要手动的复制粘贴。</p>
<h1 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h1><p>1.首先新建一个基于Maven的Java工程，我们将其命名为“project-monitor”<br>2.导入各种需要的依赖，包括spring的各种依赖，这里还导入了<code>spring-jdbc</code>的依赖包用来进行后面的数据源配置测试，<code>pom.xml</code>文件如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project-monitor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.build.timestamp.format</span>&gt;</span>yyyy-MM-dd HH:mm:ss<span class="tag">&lt;/<span class="name">maven.build.timestamp.format</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">spring-version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- spring start --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- spring end --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- log4j start --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- log4j end --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql start --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql end --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>3.定义数据源<code>bean</code>，spring上下文文件<code>project-monitor.xml</code>如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/beans/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driverClassName&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这里使用<code>${jdbc.url}</code>这种占位符形式进行配置，子项目使用时再对其进行填充使用<br>4.项目编译打包配置，修改<code>pom.xml</code>文件，添加以下配置节点：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.6<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.6<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>utf8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jar-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">archive</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">addClasspath</span>&gt;</span>true<span class="tag">&lt;/<span class="name">addClasspath</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">classpathPrefix</span>&gt;</span>jars<span class="tag">&lt;/<span class="name">classpathPrefix</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">manifestEntries</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">Implementation-Title</span>&gt;</span>project-monitor<span class="tag">&lt;/<span class="name">Implementation-Title</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">Implementation-Version</span>&gt;</span>$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">Implementation-Version</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">Implementation-Vendor</span>&gt;</span>kMacro<span class="tag">&lt;/<span class="name">Implementation-Vendor</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">Build-Time</span>&gt;</span>$&#123;maven.build.timestamp&#125;<span class="tag">&lt;/<span class="name">Build-Time</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">manifestEntries</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">archive</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>5.执行Maven编译打包命令，在项目根目录（如：D:\project-monitor）下执行以下命令（需配置Maven环境变量）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure></p>
<p>6.将打包后的Jar包安装到本地Maven仓库中，首先定位到jar所在目录（如：D:\project-monitor\target），然后执行命令：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn install:install-file -Dfile=project-monitor.jar -DgroupId=com.demo -DartifactId=project-monitor -Dversion=0.0.1 -Dpackaging=jar</span><br></pre></td></tr></table></figure></p>
<p>7.安装完成<br>8.其它工程导入该依赖：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project-monitor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>9.项目修改，只需重新执行5和6的命令即可，子项目不需任何处理</p>
<blockquote>
<p><strong>注意：</strong>pom.xml文件并不会被子项目所共享，子项目必须单独导入所有需要的依赖</p>
</blockquote>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>大功告成，一个通用灵活的自定义Maven依赖就开发完成了，这里只是介绍一下Maven依赖包的开发过程，之后会详细介绍如何在子项目中使用安装的依赖包。<br>文章项目源码已发布到Github：<a href="https://github.com/ZKHDEV/MultDependPjo" target="_blank" rel="noopener">https://github.com/ZKHDEV/MultDependPjo</a></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/12/21/java-dev2/。">https://zkhdev.github.io/2017/12/21/java-dev2/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> maven </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java开发小技巧（一）]]></title>
      <url>/2017/12/19/java-dev1/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-346b93b942ca64bf.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>最近在看公司项目源码(Java)的时候，发现项目的结构非常清晰，后期维护非常便捷，原因就是运用了很多巧妙的开发技巧，在这里也和大家分享一下，希望对你们有帮助。<br><a id="more"></a><br>相信许多程序员在看别人写的代码的时候，会有怀疑人生的感想，面对一堆天书一样的代码，很难摸清作者的思路，最后选择了重构，如果你认同上面这个作法，说明了两个问题：要么原来的开发者技术菜、要么你技术菜。</p>
<p>企业级项目的开发不是一个开发人员就能完成的，开发过程中往往会有一些需求变更、人员调动，所以代码的编写规范非常非常重要，你要确保项目交接后，后续开发人员可以看懂你的东西，知道如何进行后期的维护和功能迭代。</p>
<h1 id="1-IP地址变量化"><a href="#1-IP地址变量化" class="headerlink" title="1.IP地址变量化"></a>1.IP地址变量化</h1><p>相信大家在连接数据库的时候是这样写的：</p>
<blockquote>
<p>jdbc:mysql://127.0.0.1:3306/test</p>
</blockquote>
<p>这是连接本地MySql数据库的字符串，这句话看起来没有问题，但是大多数企业项目会把数据库独立出来，使用数据库一体机或远程数据库，这时候就需要修改上面的IP了，如果项目少这样写没什么问题，但是如果项目多了，岂不是每个项目都要去修改，这样显得非常不智能，所以解决方案来了：</p>
<h2 id="使用hosts文件使IP地址变量化"><a href="#使用hosts文件使IP地址变量化" class="headerlink" title="使用hosts文件使IP地址变量化"></a>使用hosts文件使IP地址变量化</h2><p>首先介绍一下hosts文件，它的作用就是将一些网址域名与其对应的IP地址建立一个关联，相当于本地的DNS域名解析器，当用户访问一个网址时，系统会首先从hosts文件中寻找对应的IP地址，一旦找到，系统会立即访问对应的IP，如果没有找到，则系统再会将网址提交DNS域名解析服务器进行IP地址的解析。</p>
<blockquote>
<p>Windows中hosts文件位于<code>C:\Windows\System32\drivers\etc\hosts</code>，Linux中位于<code>/etc/hosts</code></p>
</blockquote>
<p>现在我们把数据库连接字符串改成这样子：</p>
<blockquote>
<p>jdbc:mysql://mydb:3306/test</p>
</blockquote>
<p>与之前的不同之处在于，将<code>127.0.0.1</code>的IP地址改成了变量名<code>mydb</code></p>
<p>接着我们来修改hosts文件，打开hosts文件其实你可以看到，平时我们使用的<code>localhost</code>其实是默认解析到IP<code>127.0.0.1</code>上的，我们可以在文件最下面添加这样一行配置：</p>
<blockquote>
<p>127.0.0.1 mydb</p>
</blockquote>
<p>大功告成，运行项目你会发现一切正常，这就是将IP地址变量化的方法，如果之后公司要求将数据库迁移到其它地方，只需修改一下服务器的hosts文件即可，服务器上面所有的项目就能正常连接数据库了，是不是很方便呢</p>
<h1 id="2-配置文件式开发"><a href="#2-配置文件式开发" class="headerlink" title="2.配置文件式开发"></a>2.配置文件式开发</h1><p>在我们的开发中经常会有一些需要预先定义好的变量或者常量，比如数据库连接配置、Sql语句等等，如果把它们写死在代码里面，会显得很不灵活，因为Java是一种编译型开发语言，修改代码需要重新编译和部署，于是我们可以使用这种方法——将变量存放到配置文件中。</p>
<p>这样如果我们修改了变量内容，也不需要重新编译，像Spring、Mybatis等大多是Java框架都是利用这种方式来工作的。</p>
<p>下面举一个简单的例子：</p>
<p>首先我们新建一个<code>config.properties</code>的配置文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.driver=com.mysql.jdbc.Driver</span><br><span class="line">db.url=jdbc:mysql://mydb:3306/test?characterEncoding=utf8&amp;useSSL=true&amp;serverTimezone=UTC</span><br><span class="line">db.username=root</span><br><span class="line">db.password=toor</span><br></pre></td></tr></table></figure></p>
<p>这是一个简单的数据库连接配置文件，然后我们在代码中加载这个文件：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"config.properties"</span>);</span><br><span class="line"><span class="keyword">if</span>(!file.exists() &amp;&amp; file.isDirectory())&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException(<span class="string">"缺少配置文件config.properties"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">FileInputStream in = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">InputStreamReader reader = <span class="keyword">new</span> InputStreamReader(in, <span class="string">"UTF-8"</span>);  <span class="comment">//解决文件编码问题</span></span><br><span class="line">prop.load(reader);  <span class="comment">//加载配置内容到prop对象中</span></span><br></pre></td></tr></table></figure></p>
<p>这样我们就可以通过Properties提供的方法来获取相应的配置了，如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String url = prop.getProperty(<span class="string">"db.url"</span>);</span><br></pre></td></tr></table></figure></p>
<p>加载配置文件还有一种方式：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">InputStream in = getClass().getResourceAsStream(<span class="string">"config.properties"</span>);</span><br><span class="line">prop.load(in);</span><br></pre></td></tr></table></figure></p>
<p>这是通过classpath来获取配置文件，但是要求配置文件必须放在classpath中，而且需要注意的是，如果你将项目打包成jar包，配置文件也会被一起打包，没办法对文件进行修改了。</p>
<p>使用<code>Properties prop = System.getProperties();</code>还可以获取JVM的一些配置，比如系统换行符等信息，在读取解析本地文件内容时是很有用：<code>System.getProperty(&quot;line.separator&quot;)</code></p>
<p>以上只是使用配置文件的一个简单说明，这种方式在开发一些工具程序的时候非常有用。</p>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>今天先写到这吧，下一篇文章将给大家分享一个很实用的方法：利用Maven打造一个通用的工程，可以把一些通用的配置信息、类、方法进行统一管理，并且为其它工程提供服务，敬请期待哟</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/12/19/java-dev1/。">https://zkhdev.github.io/2017/12/19/java-dev1/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java实现CORS跨域请求]]></title>
      <url>/2017/09/22/java-cors/</url>
      <content type="html"><![CDATA[<p>使用前后端分离模式开发项目时，往往会遇到这样一个问题 – 无法跨域获取服务端数据，这是由于浏览器的同源策略导致的，目的是为了安全。在前后端分离开发模式备受青睐的今天，前端和后台项目往往会在不同的环境下进行开发，这时就会出现跨域请求数据的需求。<br><a id="more"></a></p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>目前的解决方案主要有以下几种：</p>
<blockquote>
<p>JSONP、iframe、代理模式、CORS等等</p>
</blockquote>
<p>前面几种方式在这里不讲，网上有很多资料。在这里我主要分享一下CORS这种解决方式，CORS即“跨域资源共享”，它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</p>
<p>使用 CORS 跨域的时候和普通的 ajax 过程是一样的，只是浏览器在发现这是一个跨域请求的时候会自动帮我们处理一些事情，所以说<strong>只要服务端提供支持，前端是不需要做额外的事情的</strong>。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><p>实现的大概思路是这样的，首先使用过滤器获取请求对象request的信息，比如Origin 字段（表示请求来自哪个源，包括协议、域名、端口），通过预先配置的参数判断请求是否合法，然后设置响应对象response的头信息，实现跨域资源请求。在介绍实现方式之前我们先来了解一下会用到的响应头信息。</p>
<h2 id="响应头"><a href="#响应头" class="headerlink" title="响应头"></a>响应头</h2><ul>
<li><p>Access-Control-Allow-Methods<br>用来列出浏览器的CORS请求允许使用的HTTP方法，如：GET、POST、PUT、DELETE、OPTIONS</p>
</li>
<li><p>Access-Control-Allow-Credentials<br>表示是否支持跨域Cookie</p>
</li>
<li><p>Access-Control-Allow-Headers<br>逗号分隔的字符串，表示服务器支持的所有头信息字段，如Content-Type以及自定义的字段</p>
</li>
<li><p>Access-Control-Expose-Headers<br>与“Access-Control-Allow-Headers”相反，表示不支持的头信息字段</p>
</li>
<li><p>Access-Control-Allow-Origin<br>允许跨域的请求源信息，包括协议、域名、端口，为<code>*</code>表示允许所有请求来源，并且<strong>只能设置一个请求源</strong></p>
</li>
</ul>
<p>下面介绍一下Java后台如何实现这种方式。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>由于最近在使用spring-boot，所以接下来以spring-boot为基础来实现。</p>
<p>首先创建一个CorsFilter过滤器，代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="meta">@WebFilter</span>(filterName = <span class="string">"corsFilter"</span>, urlPatterns = <span class="string">"/*"</span>,</span><br><span class="line">        initParams = &#123;<span class="meta">@WebInitParam</span>(name = <span class="string">"allowOrigin"</span>, value = <span class="string">"*"</span>),</span><br><span class="line">                <span class="meta">@WebInitParam</span>(name = <span class="string">"allowMethods"</span>, value = <span class="string">"GET,POST,PUT,DELETE,OPTIONS"</span>),</span><br><span class="line">                <span class="meta">@WebInitParam</span>(name = <span class="string">"allowCredentials"</span>, value = <span class="string">"true"</span>),</span><br><span class="line">                <span class="meta">@WebInitParam</span>(name = <span class="string">"allowHeaders"</span>, value = <span class="string">"Content-Type,X-Token"</span>)&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String allowOrigin;</span><br><span class="line">    <span class="keyword">private</span> String allowMethods;</span><br><span class="line">    <span class="keyword">private</span> String allowCredentials;</span><br><span class="line">    <span class="keyword">private</span> String allowHeaders;</span><br><span class="line">    <span class="keyword">private</span> String exposeHeaders;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        allowOrigin = filterConfig.getInitParameter(<span class="string">"allowOrigin"</span>);</span><br><span class="line">        allowMethods = filterConfig.getInitParameter(<span class="string">"allowMethods"</span>);</span><br><span class="line">        allowCredentials = filterConfig.getInitParameter(<span class="string">"allowCredentials"</span>);</span><br><span class="line">        allowHeaders = filterConfig.getInitParameter(<span class="string">"allowHeaders"</span>);</span><br><span class="line">        exposeHeaders = filterConfig.getInitParameter(<span class="string">"exposeHeaders"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowOrigin)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(allowOrigin.equals(<span class="string">"*"</span>))&#123;</span><br><span class="line">                response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, allowOrigin);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                List&lt;String&gt; allowOriginList = Arrays.asList(allowOrigin.split(<span class="string">","</span>));</span><br><span class="line">                <span class="keyword">if</span> (allowOriginList != <span class="keyword">null</span> &amp;&amp; allowOriginList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    String currentOrigin = request.getHeader(<span class="string">"Origin"</span>);</span><br><span class="line">                    <span class="keyword">if</span> (allowOriginList.contains(currentOrigin)) &#123;</span><br><span class="line">                        response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, currentOrigin);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowMethods)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">"Access-Control-Allow-Methods"</span>, allowMethods);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowCredentials)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">"Access-Control-Allow-Credentials"</span>, allowCredentials);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowHeaders)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, allowHeaders);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(exposeHeaders)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">"Access-Control-Expose-Headers"</span>, exposeHeaders);</span><br><span class="line">        &#125;</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>大功告成，现在前端就可以跨域获取后台的数据了，比其它方式容易得多，代码就不解释了，简单易懂，使用其它后台开发方式也一样，最终目的就是<strong>判断请求，设置响应头</strong>，前端什么事都不用做。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/09/22/java-cors/。">https://zkhdev.github.io/2017/09/22/java-cors/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[数据库记录删除方式]]></title>
      <url>/2017/09/04/db-delete/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-a6b175382e0b6b78.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>删除数据库记录是一个非常常见的需求，当数据失去价值时，我们便会删除它，但是如果操作不当，往往就会把一些有价值的数据误删掉，造成重要数据的丢失，合理采用删除方式才能更好地利用数据资源，下面介绍几种常用的删除方式。<br><a id="more"></a></p>
<h1 id="删除方式"><a href="#删除方式" class="headerlink" title="删除方式"></a>删除方式</h1><h2 id="物理删除"><a href="#物理删除" class="headerlink" title="物理删除"></a>物理删除</h2><p>物理删除就是直接从数据库中删除一条或多条记录，将数据从磁盘上擦除，可以使用<code>DELETE FROM</code>SQL语句实现，这种方式产生的后果就是记录永久性删除，无法找回，一般适用于小型或数据重要性不高的项目，可以提高数据库资源利用率。物理删除方式是一种最简单最基本的数据删除方式，这里不多做介绍，我们主要来看一下逻辑删除方式。</p>
<h2 id="逻辑删除"><a href="#逻辑删除" class="headerlink" title="逻辑删除"></a>逻辑删除</h2><p>所谓的逻辑删除就是实现记录已删除的效果，但实际上数据仍然存在于数据库中，只是对用户隐藏这一部分数据。一些大型的、数据关联性高、数据重要性高的应用往往会采用这种删除方式，它可以实现回收站、删除恢复、查看历史版本等实用功能，根据业务的需要有不同的应用场景。</p>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>例如，在一些邮箱应用中，当你删除一条邮件时，不会将邮件直接删除，而是把邮件移动到回收站，你可以在回收站中对邮件进行恢复、彻底删除等操作，可以有效防止误删等情况。<br>再比如博客管理平台一般都会提供查看修改历史、比较历史版本等功能，我们可以方便地查看文章的修改历史，以及恢复到之前某一版本。</p>
<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><h3 id="标记删除"><a href="#标记删除" class="headerlink" title="标记删除"></a>标记删除</h3><p>采用删除标记的方式可以很容易地实现逻辑删除功能，通过在表中添加一个删除标记字段，将正常记录的该字段设置为0，已删除记录的该字段设置为1，查询时添加一个<code>where</code>条件筛选删除标记为0的记录，就可以实现逻辑删除的功能，此时的删除业务只需要将记录的删除标记字段修改为1即可。</p>
<h3 id="拉链"><a href="#拉链" class="headerlink" title="拉链"></a>拉链</h3><p>拉链方式来源于数据仓库，是针对数据仓库设计中表存储数据的方式而定义的，所谓拉链，就是记录历史，记录一个事物从开始到当前状态的所有变化信息。拉链算法是目前数据仓库领域最典型的算法之一。<br>这种方式的表结构与普通表的区别在于多了两个字段（<code>START_DATE</code>&amp;<code>END_DATE</code>）表示记录的有效时间，分别为记录添加时间和记录最大有效时间。</p>
<ul>
<li><p>数据表采用联合主键的方式，使用<code>id</code>和<code>START_DATE</code>来唯一的表示某条记录，如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`table_name`</span> (</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    <span class="string">`start_date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`end_date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    ...,</span><br><span class="line">    primary <span class="keyword">key</span>(<span class="string">`id`</span>,<span class="string">`start_date`</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=MYISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新增记录时<code>START_DATE</code>可设置为当前时间，<code>END_DATE</code>设置为null或未来某个时间来表示无穷大，如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name(start_date,end_date,...) <span class="keyword">values</span>(当前时间,一百年后,...);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询数据时只要对日期进行筛选就可得到当前有效的记录，例如</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span>=记录<span class="keyword">ID</span> <span class="keyword">and</span> start_date&lt;=当前时间 <span class="keyword">and</span> end_date&gt;当前时间;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改记录的方式与传统方式不同，修改操作并不是直接修改数据库中的某条记录，而是把修改的原有效记录的<code>END_DATE</code>设置为当前时间,接下来新增一条完整的、修改后的记录，如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> table_name <span class="keyword">set</span> end_date=当前时间 <span class="keyword">where</span> <span class="keyword">id</span>=原记录<span class="keyword">ID</span> <span class="keyword">and</span> end_date=一百年后;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name(<span class="keyword">id</span>,start_date,end_date,...) <span class="keyword">values</span>(原记录<span class="keyword">ID</span>,当前时间,一百年后,...);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除操作很简单，不是真的将记录从数据表中移除，只需把记录的<code>END_DATE</code>设置为当前时间即可，如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> table_name <span class="keyword">set</span> end_date=当前时间 <span class="keyword">where</span> <span class="keyword">id</span>=删除记录<span class="keyword">ID</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过这种方式可以完整地记录下数据的变化情况，使用下面的查询语句就可以获取某条记录的完整版本列表以及查看特定版本的内容：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取版本列表</span></span><br><span class="line"><span class="keyword">select</span> start_date <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span>=记录<span class="keyword">ID</span> <span class="keyword">order</span> <span class="keyword">by</span> start_date;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看特定版本内容</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span>=记录<span class="keyword">ID</span> <span class="keyword">and</span> start_date=版本日期;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>不同的业务需要根据其应用场景来选择合适的数据删除方式，一般的应用可以采用物理删除的方式，简单粗暴地将数据擦除，这样可以有效提高数据库地利用率，如果历史数据一点价值都没有或者价值不高，那还留着干什么，这时如果采用逻辑删除地方式反而加重了数据库的负担，浪费了大量宝贵的资源。但是有些项目如金融、交通、能源等领域的历史数据，往往具有很高的利用价值，通过对这些数据进行分析总结，可以更好的了解该领域的发展情况和健康程度，以及对未来的发展规划起到一定指导作用，这时就要采用逻辑删除的方式，虽然数据管理平台为了便于管理，删除了过期的数据，但数据分析系统仍能从数据库中获取到历史数据，通过抽取转换加载的过程，将历史数据转化为高价值的内容，这是目前信息技术发展的主要趋势。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/09/04/db-delete/。">https://zkhdev.github.io/2017/09/04/db-delete/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 大数据 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JS设计模式（三） 数据访问对象模式]]></title>
      <url>/2017/07/31/js-dao/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1f0d1bdc6a06f32b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2" alt=""></p>
<p>HTML5提供了两种在客户端存储数据的新方法：localStorage、sessionStorage，他们是Web Storage API 提供的两种存储机制，区别在于前者属于永久性存储，而后者是局限于当前窗口的数据传递，存储在其中的数据会在当前会话结束时被删除。<br><a id="more"></a><br>localStorage、sessionStorage的具体内容在这里就不多做介绍了，我们主要探讨一下在实际开发中怎样合理使用他们。</p>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>大部分网站会将一些数据（如：用户Token）存储在前端，用来实现页面间的传值，对于一些大型Web应用来说，其存储的数据可能会非常多，数据的管理会变得复杂，并且一个大型项目是由多位程序员共同开发的，这时就会遇到一个问题：怎样确保自己的数据不会覆盖掉其他人的呢？因为在一个页面中大家都是使用同一个WebStorage对象，总不能把大家使用过的Key记录下来吧。这时候就可以使用<strong>数据访问对象模式</strong>来解决了。</p>
<h1 id="数据访问对象模式（DAO）"><a href="#数据访问对象模式（DAO）" class="headerlink" title="数据访问对象模式（DAO）"></a>数据访问对象模式（DAO）</h1><p>数据访问对象模式就是对数据源的访问与存储进行封装，提供一个数据访问对象类负责对存储的数据进行管理和操作，规范数据存储格式，类似于后台的DAO层。<br>由于WebStorage采用Key-Value的方式存取数据，而且只能存字符串（任何类型存储的时候都会被转为字符串，读取的时候需要进行类型转换），所以我们可以对Key的格式进行规范，比如模块名+Key，开发人员+Key等，还可以在值中添加一段前缀用来描述数据，如添加数据过期日期的时间戳，用来管理数据的生命周期。具体格式项目组可以自己定义，主要是便于管理，防止出现冲突，约定好规范后就可以开始定义数据访问对象了。</p>
<p>下面以localStorage为例，介绍一下数据访问对象类的定义和使用。</p>
<h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><h3 id="DAO类基本结构"><a href="#DAO类基本结构" class="headerlink" title="DAO类基本结构"></a>DAO类基本结构</h3><p>数据访问对象类的基本结构如下，我们给键值添加了一段前缀用来避免键值冲突，并且在值中加入数据过期时间戳以及分隔符，获取值的时候再进行判断是否过期，这样可以更灵活地管理存储数据的生命周期。这里还用到了回调的方式，方便获取数据访问过程的具体结果，以及在必要时执行相关操作。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * LocalStorage数据访问类</span></span><br><span class="line"><span class="comment"> * @param &#123;string&#125; prefix Key前缀</span></span><br><span class="line"><span class="comment"> * @param &#123;string&#125; timeSplit 时间戳与存储数据之间的分割符</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> Dao = <span class="function"><span class="keyword">function</span> (<span class="params">prefix, timeSplit</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.prefix = prefix;</span><br><span class="line">    <span class="keyword">this</span>.timeSplit = timeSplit || <span class="string">'|-|'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// LocalStorage数据访问类原型方法</span></span><br><span class="line">Dao.prototype = &#123;</span><br><span class="line">    <span class="comment">// 操作状态</span></span><br><span class="line">    status: &#123;</span><br><span class="line">        SUCCESS: <span class="number">0</span>,     <span class="comment">// 成功</span></span><br><span class="line">        FAILURE: <span class="number">1</span>,     <span class="comment">// 失败</span></span><br><span class="line">        OVERFLOW: <span class="number">2</span>,    <span class="comment">// 溢出</span></span><br><span class="line">        TIMEOUT: <span class="number">3</span>      <span class="comment">// 过期</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 本地存储对象</span></span><br><span class="line">    storage: localStorage || <span class="built_in">window</span>.localStorage,</span><br><span class="line">    <span class="comment">// 获取带前缀的真实键值</span></span><br><span class="line">    getKey: <span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.prefix + key;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 添加（修改）数据</span></span><br><span class="line">    set: <span class="function"><span class="keyword">function</span> (<span class="params">key, value, callback, time</span>) </span>&#123;</span><br><span class="line">       ...</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params">key, callback</span>) </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 删除数据</span></span><br><span class="line">    remove: <span class="function"><span class="keyword">function</span> (<span class="params">key, callback</span>) </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="添加（修改）数据"><a href="#添加（修改）数据" class="headerlink" title="添加（修改）数据"></a>添加（修改）数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 添加（修改）数据</span></span><br><span class="line"><span class="comment">    * @param key 数据字段标识</span></span><br><span class="line"><span class="comment">    * @param value 数据值</span></span><br><span class="line"><span class="comment">    * @param callback 回调函数</span></span><br><span class="line"><span class="comment">    * @param time 过期时间</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    set: <span class="function"><span class="keyword">function</span> (<span class="params">key, value, callback, time</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 默认为成功状态</span></span><br><span class="line">        <span class="keyword">var</span> status = <span class="keyword">this</span>.status.SUCCESS,</span><br><span class="line">            key = <span class="keyword">this</span>.getKey(key);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取过期时间戳</span></span><br><span class="line">            time = <span class="keyword">new</span> <span class="built_in">Date</span>(time).getTime() || time.getTime();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="comment">// 未设置过期时间时默认为一个月</span></span><br><span class="line">            time = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() + <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 向本地存储中添加（修改）数据</span></span><br><span class="line">            <span class="keyword">this</span>.storage.setItem(key, time + <span class="keyword">this</span>.timeSplit + value);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="comment">// 发生溢出</span></span><br><span class="line">            status = <span class="keyword">this</span>.status.OVERFLOW;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 执行回调并传入参数</span></span><br><span class="line">        callback &amp;&amp; callback.call(<span class="keyword">this</span>, status, key, value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取数据</span></span><br><span class="line"><span class="comment">    * @param key 数据字段标识</span></span><br><span class="line"><span class="comment">    * @param callback 回调函数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params">key, callback</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> key = <span class="keyword">this</span>.getKey(key),</span><br><span class="line">            status = <span class="keyword">this</span>.status.SUCCESS,    <span class="comment">// 获取数据状态</span></span><br><span class="line">            value = <span class="literal">null</span>;    <span class="comment">// 获取数据值</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 从本地存储获取数据</span></span><br><span class="line">            value = <span class="keyword">this</span>.storage.getItem(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="comment">// 获取数据失败</span></span><br><span class="line">            status = <span class="keyword">this</span>.status.FAILURE;</span><br><span class="line">            value = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果成功获取数据</span></span><br><span class="line">        <span class="keyword">if</span> (status !== <span class="keyword">this</span>.status.FAILURE) &#123;</span><br><span class="line">            <span class="keyword">var</span> index = value.indexOf(<span class="keyword">this</span>.timeSplit),</span><br><span class="line">                timeSplitLen = <span class="keyword">this</span>.timeSplit.length,</span><br><span class="line">                <span class="comment">// 获取时间戳</span></span><br><span class="line">                time = value.slice(<span class="number">0</span>, index);</span><br><span class="line">            <span class="comment">// 判断数据是否未过期</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1</span>*time).getTime() &gt; <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() || time == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 获取数据值</span></span><br><span class="line">                value = value.slice(index + timeSplitLen);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 数据已过期，删除数据</span></span><br><span class="line">                value = <span class="literal">null</span>;</span><br><span class="line">                status = <span class="keyword">this</span>.status.TIMEOUT;</span><br><span class="line">                <span class="keyword">this</span>.remove(key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行回调</span></span><br><span class="line">        callback &amp;&amp; callback.call(<span class="keyword">this</span>, status, value);</span><br><span class="line">        <span class="comment">// 返回结果值</span></span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 删除数据</span></span><br><span class="line"><span class="comment">    * @param key 数据字段标识</span></span><br><span class="line"><span class="comment">    * @param callback 回调函数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    remove: <span class="function"><span class="keyword">function</span> (<span class="params">key, callback</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 设置默认状态为失败</span></span><br><span class="line">        <span class="keyword">var</span> status = <span class="keyword">this</span>.status.FAILURE,</span><br><span class="line">            key = <span class="keyword">this</span>.getKey(key),</span><br><span class="line">            value = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取数据值</span></span><br><span class="line">            value = <span class="keyword">this</span>.storage.getItem(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="comment">// 数据不存在，不采取操作</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果数据存在</span></span><br><span class="line">        <span class="keyword">if</span> (value) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 删除数据</span></span><br><span class="line">                <span class="keyword">this</span>.storage.removeItem(key);</span><br><span class="line">                status = <span class="keyword">this</span>.status.SUCCESS;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                <span class="comment">// 数据删除失败，不采取操作</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 执行回调并传入参数，删除成功则传入被删除的数据值</span></span><br><span class="line">        callback &amp;&amp; callback.call(<span class="keyword">this</span>, status, status &gt; <span class="number">0</span> ? <span class="literal">null</span> : value.slice(value.indexOf(<span class="keyword">this</span>.timeSplit) + <span class="keyword">this</span>.timeSplit.length));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dao = <span class="keyword">new</span> Dao(<span class="string">'myModule_'</span>);</span><br><span class="line"><span class="comment">// 添加/修改数据</span></span><br><span class="line">dao.set(<span class="string">'token'</span>, <span class="string">'abc'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); &#125;);</span><br><span class="line"><span class="comment">// 获取数据</span></span><br><span class="line"><span class="keyword">var</span> value = dao.get(<span class="string">'token'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(value);</span><br><span class="line"><span class="comment">// 删除数据</span></span><br><span class="line">dao.remove(<span class="string">'token'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); &#125;);</span><br></pre></td></tr></table></figure>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>其实数据访问对象模式更适合与服务器端的数据库操作，比如在nodejs中操作MongoDB，通过对数据库增删改查操作的封装，可以方便我们对前端存储的管理，不必为操作数据库感到烦恼，DAO已经为我们提供了便捷统一的接口，这样在团队开发中就不用担心影响到其他人的数据了。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/07/31/js-dao/。">https://zkhdev.github.io/2017/07/31/js-dao/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[数据仓库 - Teradata学习体会]]></title>
      <url>/2017/07/30/teradata/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-3a8a8be63de67b76.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>随着计算机系统在处理能力、存储能力等方面，特别是计算机软件技术的不断提高，使得信息处理技术得到飞速发展。数据处理主要分为两大类：联机事物处理OLTP、联机分析处理OLAP。OLTP也就是传统的关系型数据库应用，主要功能是基本的、日常的事务处理操作，对响应时间要求非常高，是一种面向应用的生产系统。OLAP是基于数据仓库的面向主题的信息分析处理过程。<br><a id="more"></a></p>
<h1 id="什么是数据仓库"><a href="#什么是数据仓库" class="headerlink" title="什么是数据仓库"></a>什么是数据仓库</h1><p>与传统关系型数据库不同的是，数据仓库储存的是历史数据，针对数据仓库系统的查询大都非常复杂，特别消耗系统资源，对系统的可扩展能力和并行处理能力要求很高。数据仓库主要面向业务人员和管理人员，用来帮助企业管理人员作出更符合业务发展规律的决策，所以也称数据仓库为决策支持系统。数据仓库的数据来自多个数据库，并且按照预先定义好的模型对抽取的数据进行转换过滤，再将结果存放到数据仓库中。</p>
<h1 id="Teradata-数据库"><a href="#Teradata-数据库" class="headerlink" title="Teradata 数据库"></a>Teradata 数据库</h1><p>为了解决传统数据库在大量数据的查询分析等方面的局限性，Teradata公司推出了Teradata关系数据库管理系统。Teradata采用标准的SQL查询语言，适用于处理复杂查询数据仓库应用。   </p>
<h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>Teradata的主要组件是<strong>解析引擎、BYNET和访问模块处理器（AMP）</strong>。<br><img src="http://upload-images.jianshu.io/upload_images/5266042-ea5f11bcecc5720d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<ul>
<li>解析引擎负责从客户端接收查询命令并制定执行计划。</li>
<li>BYNET相当于网络层，它从解析引擎接收执行计划并发送给相应的AMP，AMP的选择采用哈希算法实现。</li>
<li>数据表中的记录均匀分布在个AMP之间，每个AMP与存储数据的一组磁盘相关联。从BYNET接收数据和执行计划后，进行类型转换、聚合、过滤和排序等操作并将数据存储到与其关联的磁盘中。</li>
</ul>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>使用Teradata提供的免费Teradata数据库开发人员版本可以进行开发测试，通过Teradata SQL Assistant或BTEQ等数据库管理工具可以对数据仓库进行操作，默认用户为DBC，SQL语法和其它数据库区别不大，但其独特的内部结构适合需要处理复杂数据查询的应用。</p>
<h2 id="SQL-语法"><a href="#SQL-语法" class="headerlink" title="SQL 语法"></a>SQL 语法</h2><p>Teradata使用了标准的SQL语法并在此基础上进行了扩展，以增强数据库管理系统的功能。所有的系统对象如Table、View、Macro等存储在数据字典中，数据字典的所有者为DBC用户，在客户端可以调用数据字典中的对象访问数据库。刚开始使用Teradata时可以使用其帮助系统提供的命令HELP、SHOW、EXPLAIN查看数据库中各种对象的结构以及SQL请求的执行过程，对理解Teradata工作原理以及各种SQL语句的使用有很大帮助。</p>
<h1 id="体会"><a href="#体会" class="headerlink" title="体会"></a>体会</h1><p>在如今快速发展的大数据革命时代，数据积累量越来越多，其中蕴含着大量重要的信息，通过对这些数据进行分析和综合处理，可以发掘出对企业发展、政府管理部门至关重要的业务信息，帮助管理人员作出合理的决策。  </p>
<p>当然，传统的关系型数据库也是可以完成基本的事务处理和数据分析操作的，但是当数据量非常庞大时，数据库就显得无能为力了。比如，一个早期的电商平台，只需一个网站、几台服务器、一个MySQL就可以运营了，当客户增多、数据量增大时，只需采用多台服务器、多个数据库的方式就可以勉强应付，但是随着数据量的不断增长，数据之间的关系也越来越复杂，管理人员此时关心的不是“昨天营业额是多少”这类问题，而是“哪些用户是高价值用户”、“某商品的销售量与哪些因素有关”等，这时就需要建立数据仓库了，Teradata数据仓库是专门针对决策支持系统的特点而开发的关系数据库管理系统，相对于其它商业数据库，Teradata更适合需要处理大数据量及数据分析的应用，可以极大提高应用的性能。  </p>
<p>数据库可以存储和处理数据，而数据仓库的职责则是发掘数据的价值，最大程度地利用数据。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/07/30/teradata/。">https://zkhdev.github.io/2017/07/30/teradata/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 大数据 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> 数据仓库 </tag>
            
            <tag> teradata </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JS设计模式（二） 惰性模式]]></title>
      <url>/2017/04/26/js-lazy/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1f0d1bdc6a06f32b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2" alt=""></p>
<p>惰性模式，可以减少代码每次执行时的重复性判断，通过重新定义对象来避免原对象中的分支判断，提高网站性能。<br><a id="more"></a><br>例如针对不同浏览器的事件注册方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> AddEvent = <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dom.addEventListener)&#123;</span><br><span class="line">  	dom.addEventListener(type, fn, <span class="literal">false</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(dom.attachEvent)&#123;</span><br><span class="line">  	dom.attachEvent(<span class="string">'on'</span>+type, fn);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  	dom[<span class="string">'on'</span>+type] = fn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面的方法可以发现，每次为元素绑定事件时，都会进行检测判断，这是多余的，因为在同一浏览器中分支判断结果是唯一的，不可能走不同的分支。</p>
<p>我们可以用惰性模式来解决这个问题，既然第一次调用该方法时已经判断过了，那么就可以在第一次执行时根据判断结果重新定义该方法。</p>
<p>惰性模式主要有两种实现方法：</p>
<ul>
<li><p>加载即执行：JavaScript文件加载时通过闭包执行对方法进行重新定义，在页面加载时会消耗一定的资源。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> AddEvent = <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dom.addEventListener)&#123;</span><br><span class="line">  	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  		dom.addEventListener(type, fn, <span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(dom.attachEvent)&#123;</span><br><span class="line">  	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">    	dom.attachEvent(<span class="string">'on'</span>+type, fn);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  		dom[<span class="string">'on'</span>+type] = fn;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>
</li>
<li><p>惰性执行：第一次执行函数时在函数内部对其进行显示重写，最后调用重写后的方法完成第一次方法调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> AddEvent = <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dom.addEventListener)&#123;</span><br><span class="line">  	AddEvent = <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  		dom.addEventListener(type, fn, <span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(dom.attachEvent)&#123;</span><br><span class="line">  	AddEvent = <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">    	dom.attachEvent(<span class="string">'on'</span>+type, fn);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  	AddEvent = <span class="function"><span class="keyword">function</span>(<span class="params">dom, type, fn</span>)</span>&#123;</span><br><span class="line">  		dom[<span class="string">'on'</span>+type] = fn;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> AddEvent(dom, type, fn);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>与<strong>加载即执行</strong>不同的是，JS文件加载完成后，<strong>惰性执行</strong>的函数还没有被重新定义，当函数被首次调用时才会被重定义。这两种惰性方式都避免了冗余的分支判断。</p>
<p>惰性模式的应用场景非常广泛，特别是当今浏览器种类繁多的现象，很多功能在不同浏览器中实现不一，为了兼容不同的浏览器，代码中往往会有许多对不同浏览器的分支判断，比如事件处理、XMLHttpRequest对象创建等，造成代码臃肿冗余，惰性模式正好可以解决这种问题，提高代码执行效率。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/04/26/js-lazy/。">https://zkhdev.github.io/2017/04/26/js-lazy/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript设计模式（一） 单例模式]]></title>
      <url>/2017/04/22/js-single/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1f0d1bdc6a06f32b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2" alt=""></p>
<p>单例模式是JavaScript中最常见的一种模式，通过这种模式可以为我们提供一个命名空间，例如jQuery库的命名空间为 jQuery 或 $ 。<br><a id="more"></a></p>
<h1 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h1><p>命名空间的使用是为了让代码更加整洁，在多人协作开发的情况下，不同的人定义的变量很有可能重复，此时就需要使用命名空间来约束每个人定义的变量，使相同名称的变量放在不同的命名空间中，避免相互干扰。</p>
<p>例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A程序员的命名空间</span></span><br><span class="line"><span class="keyword">var</span> A = &#123;</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    css: <span class="function"><span class="keyword">function</span>(<span class="params">id,key,value</span>)</span>&#123;</span><br><span class="line">        get(id).style[key] = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// B程序员的命名空间</span></span><br><span class="line"><span class="keyword">var</span> B = &#123;</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params">className</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementByClassName(className)[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    css: <span class="function"><span class="keyword">function</span>(<span class="params">className,key,value</span>)</span>&#123;</span><br><span class="line">        get(className).style[key] = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>A、B两个命名空间中都有一个<code>get</code>方法和一个<code>css</code>方法，用于元素获取和元素样式修改，不同的是A是通过<code>id</code>来获取元素，而B是通过<code>class</code>来获取元素，通过命名空间，可以使这些相同名称的方法共存，使用时指定相应的命名空间即可。</p>
<h1 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h1><p>JavaScript中单例模式除了定义命名空间之外，还可用于管理代码库的各个功能模块。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">google.dom.addClass             <span class="comment">// 添加元素类</span></span><br><span class="line">google.dom.append               <span class="comment">// 插入元素</span></span><br><span class="line">google.event.stopPropagation    <span class="comment">// 阻止事件冒泡</span></span><br><span class="line">google.event.preventDefault     <span class="comment">// 阻止默认行为</span></span><br><span class="line">google.string.trim              <span class="comment">// 去除字符串首尾空格</span></span><br><span class="line">google.string.encodeHTML        <span class="comment">// 将字符串进行HTML编码</span></span><br></pre></td></tr></table></figure></p>
<p>以上各个模块都位于google命名空间下，每个模块都有属于自己的方法，使用时只需按照需求调用特定功能模块下对应的方法即可。</p>
<h1 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h1><p>JavaScript中并没有<code>final</code>、<code>static</code>这类关键字用来定义常量，但JavaScript非常灵活，通过常量只能访问不能修改这一特点，我们可以将变量保存在函数内部，并且只提供获取变量的方法，不提供设置变量的方法，通过闭包的方式使函数执行一次并返回相应的访问方法对象，最后将这个对象放在全局空间中作为常量单例对象使用。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Color = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 私有变量</span></span><br><span class="line">    <span class="keyword">var</span> color = &#123;</span><br><span class="line">        <span class="string">'RED'</span>: <span class="string">'#ff0000'</span>,</span><br><span class="line">        <span class="string">'YELLOW'</span>: <span class="string">'#ffff00'</span>,</span><br><span class="line">        <span class="string">'BLUE'</span>: <span class="string">'#0000ff'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回访问方法对象</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// 常量获取方法</span></span><br><span class="line">        get: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> color[name] ? color[name] : <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> color = Color.get(<span class="string">'BLUE'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(color);    <span class="comment">// #0000ff</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/04/22/js-single/。">https://zkhdev.github.io/2017/04/22/js-single/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript 面向对象编程]]></title>
      <url>/2017/04/21/js-object/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1f0d1bdc6a06f32b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>面向对象编程就是将你的需求抽象成一个对象，针对这个对象分析其特征（属性）和动作（方法），这个对象称为“类”。JavaScript 的核心是支持面向对象的，同时它也提供了强大灵活的 OOP 语言能力，遗憾的是对于JavaScript这种解释性的弱类型语言，没有强类型语言中那种通过class等关键字实现类的方式，但JavaScript可以通过一些特性模仿实现面向对象编程。<br><a id="more"></a><br>面向对象有三个基本特征：<code>封装</code>、<code>继承</code>、<code>多态</code>。</p>
<h1 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h1><p>封装，就是把客观事物封装成抽象的类，类中包含了事物的属性和方法，并且类可以把自己的数据和方法只让可信的类或者对象操作，对不可信的进行信息隐藏。<br>JavaScript创建一个类很容易，通过声明一个函数保存在一个变量里来实现，这个类的类名通常会采用首字母大写的形式来表示，然后在这个函数（类）的内部使用<code>this</code>关键字来定义类的属性和方法。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person = <span class="function"><span class="keyword">function</span>(<span class="params">name,sex,age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>也可以在类的原型上添加属性和方法。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// Say something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>或者<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype = &#123;</span><br><span class="line">    say: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; … &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这样就完成了Person类的封装，当我们要使用这个类时，需要通过<code>new</code>关键字来实例化（创建）一个新的对象，通过<code>.</code>操作符访问对象的属性和方法。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">'Scott'</span>,<span class="string">'male'</span>,<span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">// Scott</span></span><br></pre></td></tr></table></figure></p>
<p>通过<code>this</code>添加的属性和方法是在当前对象上添加的，而JavaScript是一种基于原型prototype的语言，每创建一种对象时，都有一个原型prototype用于指向其继承的属性和方法，通过prototype继承的属性和方法不是属于对象本身的，在使用这些方法时，会通过原型链进行查找。当创建一个对象时，会创建this指向的属性和方法，而通过prototype继承的属性或方法是该类的每个对象所共有的，不会再次创建。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-b3d4da9687978acc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>当创建一个函数或者对象时都会为其创建一个prototype对象，原对象中的<code>__proto__</code>属性指向该原型对象，prototype对象中会有一个<code>constructor</code>属性指向拥有整个原型对象的函数或者类。</p>
<p>通过<code>new</code>关键字创建对象时实际上是对新对象中<code>this</code>的不断赋值，并将prototype指向类的原型对象，而在类外通过<code>.</code>操作符定义的属性和方法是不会添加到新建对象上的，通过对象进行访问的结果是undefined。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Person.isChinese = <span class="literal">true</span>;</span><br><span class="line">Person.eat = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; … &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">"Alex"</span>,<span class="string">"female"</span>,<span class="number">19</span>);</span><br><span class="line"><span class="built_in">console</span>.log(person.name);    <span class="comment">// Alex</span></span><br><span class="line"><span class="built_in">console</span>.log(person.isChinese);    <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(person.eat());    <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></p>
<p>如果你忽略了<code>new</code>关键字直接调用类，如：<figure class="highlight plain"><figcaption><span>person </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">要解决这个问题可以采用“**安全模式**”，例如：</span><br><span class="line">``` javascript</span><br><span class="line">var Person = function(name,sex,age)&#123;</span><br><span class="line">    if(this instanceof Person)&#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.sex = sex;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;else&#123;    // 未使用 new</span><br><span class="line">        return new Person(name,sex,age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var person = Person(&quot;Scott&quot;,&quot;male&quot;,20);</span><br></pre></td></tr></table></figure></p>
<p>这样就不用当心创建对象时忘记使用<code>new</code>关键字了。</p>
<h1 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h1><p>继承可以使用现有类的所有功能，并在无需重新编写原来的类的情况下对这些功能进行扩展。继承所涉及的对象不止一个，JavaScript并没有提供继承这一现有的机制，也正因为JavaScript少了这些显性的限制，使其更具有灵活性。在JavaScript中可以使用<strong>类式继承</strong>、<strong>构造函数继承</strong>、<strong>组合继承</strong>来达到继承的效果。</p>
<h2 id="类式继承"><a href="#类式继承" class="headerlink" title="类式继承"></a>类式继承</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明父类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.parentValue = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为父类添加共有方法</span></span><br><span class="line">Parent.prototype.getParentValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.parentValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明子类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.childValue = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 继承父类</span></span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent();</span><br><span class="line"><span class="comment">// 为子类添加共有方法</span></span><br><span class="line">Child.prototype.getChildValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.childValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类的原型对象的作用是为类的原型添加共有属性和方法，但类必须通过原型prototype来访问这些属性和方法。当实例化一个父类时，新建对象<strong>复制</strong>了父类构造函数内的属性和方法，并且将原型<code>__proto__</code>指向了父类的原型对象，这样就拥有了父类原型对象上的属性和方法，新建对象可以直接访问父类原型对象的属性和方法，接着将这个新建的对象赋值给子类的原型，那么子类的原型就可以访问父类的原型属性和方法。将这个对象赋值给子类的原型，那么这个子类就可以访问父类原型上的属性和方法，并且可以访问从父类构造函数中复制的属性和方法。我们可以来测试一下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child();</span><br><span class="line"><span class="built_in">console</span>.log(child.getParentValue());      <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(child.getChildValue());       <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(child <span class="keyword">instanceof</span> Parent);     <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(child <span class="keyword">instanceof</span> Child);      <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(Child <span class="keyword">instanceof</span> Parent);     <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<p>但这种继承方式有2个缺点：</p>
<ul>
<li><p>由于子类是通过其原型prototype对父类实例化，如果父类中的共有属性是<strong>引用类型</strong>，会被所有实例所共享，一个子类的实例修改了该属性会直接影响到所有实例。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.values = [<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent();</span><br><span class="line"><span class="keyword">var</span> child1 = <span class="keyword">new</span> Child();</span><br><span class="line"><span class="keyword">var</span> child2 = <span class="keyword">new</span> Child();</span><br><span class="line"><span class="built_in">console</span>.log(child2.values);    <span class="comment">// ["A","B","C"]</span></span><br><span class="line">child1.values.push(<span class="string">'D'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child2.values);    <span class="comment">// ["A","B","C","D"]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建父类实例时，是无法向父类传递参数的，也就是无法对父类构造函数内的属性进行初始化。例如这种错误的继承方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent(<span class="string">'name'</span>);    <span class="comment">// 错误</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="构造函数继承"><a href="#构造函数继承" class="headerlink" title="构造函数继承"></a>构造函数继承</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明父类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.values = [<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>];</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.showName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 声明子类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    Parent.call(<span class="keyword">this</span>,name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> child1 = <span class="keyword">new</span> Child(<span class="string">'one'</span>);</span><br><span class="line"><span class="keyword">var</span> child2 = <span class="keyword">new</span> Child(<span class="string">'two'</span>);</span><br><span class="line">child1.values.push(<span class="string">'D'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child1.name);   <span class="comment">// one</span></span><br><span class="line"><span class="built_in">console</span>.log(child1.values); <span class="comment">// ["A","B","C","D"]</span></span><br><span class="line"><span class="built_in">console</span>.log(child2.name);   <span class="comment">// two</span></span><br><span class="line"><span class="built_in">console</span>.log(child2.values); <span class="comment">// ["A","B","C"]</span></span><br><span class="line">child1.showName();          <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure>
<p>语句<code>Parent.call(this,name);</code>是构造函数继承的精华，<code>call</code>方法可以更改函数的作用环境，在子类中执行该方法相当于将子类的变量在父类中执行一遍，此时父类方法中的<code>this</code>属性指的是子类中的<code>this</code>，由于父类中是给<code>this</code>绑定属性的，所以子类也就继承了父类的属性和方法。构造函数继承并没有涉及原型prototype，所以父类的原型方法不会被子类继承，子类的每个实例会单独拥有一份父类的属性方法而不能共用，如果想被子类继承就必须放在构造函数中，要实现这样的效果可以采用<strong>组合继承</strong>的方式。    </p>
<h2 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h2><p>类式继承是通过子类的原型prototype对父类实例化来实现的，构造函数继承是通过在子类的构造函数作用环境中执行一次父类的构造函数来实现的，而组合继承则同时做到这两点。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明父类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.values = [<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>];</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 声明子类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name,id</span>)</span>&#123;</span><br><span class="line">    Parent.call(<span class="keyword">this</span>, name);</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent();</span><br><span class="line">Child.prototype.getId = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child1 = <span class="keyword">new</span> Child(<span class="string">'child1'</span>, <span class="number">1</span>);</span><br><span class="line">child1.values.push(<span class="string">'D'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child1.values); <span class="comment">// ["A", "B", "C", "D"]</span></span><br><span class="line">child1.getName();           <span class="comment">// child1</span></span><br><span class="line">child1.getId();             <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child2 = <span class="keyword">new</span> Child(<span class="string">'child2'</span>, <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child2.values);    <span class="comment">// ["A", "B", "C"]</span></span><br><span class="line">child2.getName();              <span class="comment">// child2</span></span><br><span class="line">child2.getId();                <span class="comment">// 2</span></span><br></pre></td></tr></table></figure></p>
<p>子类的实例中更改父类继承下来的引用类型属性，不会影响到其它实例，并且子类实例化过程中又能将参数传递到父类的构造函数中。</p>
<h1 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h1><p>多态就是同一个方法多种调用方式，JavaScript可以通过对传入的参数列表<code>arguments</code>进行判断来实现多种调用方式。例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Add</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 无参数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zero</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 一个参数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">one</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 两个参数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">two</span>(<span class="params">num1, num2</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 获取参数列表及参数个数</span></span><br><span class="line">        <span class="keyword">var</span> arg = <span class="built_in">arguments</span>,</span><br><span class="line">            len = arg.length;</span><br><span class="line">        <span class="keyword">switch</span>(len)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> zero();</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> one(arg[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> two(arg[<span class="number">0</span>], arg[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> A = <span class="keyword">new</span> Add();</span><br><span class="line"><span class="built_in">console</span>.log(A.add());       <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(A.add(<span class="number">1</span>));      <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(A.add(<span class="number">1</span>,<span class="number">2</span>));    <span class="comment">// 3</span></span><br></pre></td></tr></table></figure></p>
<p>当调用add进行运算时，会根据参数列表的不同做相应的运算，这就是JavaScript的多态实现方式。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>面向对象设计方法的应用解决了传统结构化开发方法中客观世界描述工具与软件结构的不一致性问题，缩短了开发周期，解决了从分析和设计到软件模块结构之间多次转换映射的繁杂过程，是一种高效率的软件开发方式，特别是在多人协作开发的情况下，可以提高代码的可复用性和维护性，使开发更有效率。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/04/21/js-object/。">https://zkhdev.github.io/2017/04/21/js-object/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[impress.js 创建演示文档]]></title>
      <url>/2017/04/05/front-impressjs/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-ad2f163a63167dc7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>impress.js是一个基于CSS3和现代浏览器，受Prezi.com的启发而创作出来的前端多功能演示js框架，可以用它来替代PowerPoint制作更加酷炫的PPT，如果你是一位前端开发者或者勉强了解HTML和CSS，都能很快上手。<br><a id="more"></a><br>这是一个<a href="http://impress.github.io/impress.js/#/bored" target="_blank" rel="noopener">官方Demo</a>，效果不错吧。</p>
<p>impress.js 是基于 webkit 浏览器（Chrome、Safari）开发，在其它基于非 webkit 引擎，但支持 CSS3 3D 的浏览器也能正常运行。</p>
<p>impress.js源码已经发布在GitHub上，地址：<a href="https://github.com/impress/impress.js" target="_blank" rel="noopener">https://github.com/impress/impress.js</a></p>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="引入impress-js文件并初始化"><a href="#引入impress-js文件并初始化" class="headerlink" title="引入impress.js文件并初始化"></a>引入impress.js文件并初始化</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"impress.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;impress().init();&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="根结点"><a href="#根结点" class="headerlink" title="根结点"></a>根结点</h2><p>impress.js需要一个id为<code>impress</code>的根元素，演示文档的所有内容都包含在该元素中。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"impress"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="步骤结点"><a href="#步骤结点" class="headerlink" title="步骤结点"></a>步骤结点</h2><p>步骤元素包含将在屏幕中呈现的内容，是演示文档的基本单元，相当于一张幻灯片，每个步骤元素包含名为<code>step</code>的class<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"step"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">q</span>&gt;</span>这是第一张页面<span class="tag">&lt;/<span class="name">q</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在该元素中可以定义各种精彩呈现效果的属性，用来表示页面以怎样的方式出现到屏幕中央。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data-x = 幻灯片x坐标</span><br><span class="line">data-y = 幻灯片y坐标</span><br><span class="line">data-scale = 缩放比例</span><br><span class="line">data-rotate = 平面旋转角度</span><br><span class="line">data-rotate-x = x轴旋转角度(3D)</span><br><span class="line">data-rotate-y = y轴旋转角度(3D)</span><br><span class="line">data-rotate-z = z轴旋转角度(3D)</span><br></pre></td></tr></table></figure></p>
<p>现在你已经了解了基本的动画属性，可以大胆发挥你的创意创建令人惊奇的幻灯片效果。</p>
<h2 id="CSS-class"><a href="#CSS-class" class="headerlink" title="CSS class"></a>CSS class</h2><ul>
<li><strong>future</strong><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.future</span> &#123;</span><br><span class="line">   display：none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>该类添加在还未展示的步骤结点，当该元素被导航时会自动删除<code>future</code>类，显示页面。</p>
<ul>
<li><p><strong>present</strong><br>该类会被自动添加到目前位于屏幕中央的步骤结点，这对幻灯片展示时的动画效果非常有用。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.present</span> <span class="selector-class">.rotating</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-10deg);</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.25s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>past</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.past</span> &#123;</span><br><span class="line">   display：none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>该类会在步骤元素被导航过后自动添加。</p>
<ul>
<li><p><strong>active</strong><br>该类会被自动添加到当前的步骤元素，与<code>present</code>class类似</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.step</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.3</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.step</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>impress-on-*</strong><br>用于定义每个步骤结点的样式，步骤结点的id可以在URL中看到，如<code>#/step-1</code>，例如：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.impress-on-overview</span> <span class="selector-class">.step</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.impress-on-step-1</span>,</span><br><span class="line"><span class="selector-class">.impress-on-step-2</span>,</span><br><span class="line"><span class="selector-class">.impress-on-step-3</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: LightBlue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><ul>
<li><p><strong>impress([id])</strong><br>一个用于创建<code>ImpressAPI</code>的工厂方法，可以自定义根结点，然后调用该方法进行初始化：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> impressAPI = impress( <span class="string">"root"</span> );</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>impress().init()</strong><br>初始化impress</p>
</li>
<li><p><strong>next()</strong><br>导航到下一页</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> api = impress();</span><br><span class="line">api.init();</span><br><span class="line">api.next();</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>prev()</strong><br>导航到上一页</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> api = impress();</span><br><span class="line">api.init();</span><br><span class="line">api.prev();</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>goto( stepIndex | stepElementId | stepElement, [ duration ] )</strong><br>导航到特定页面</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> api = impress();</span><br><span class="line">api.init();</span><br><span class="line">api.goto(<span class="number">7</span>);    <span class="comment">//Number ID</span></span><br><span class="line">api.goto( <span class="string">"overview"</span> );     <span class="comment">//String ID</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> overview = <span class="built_in">document</span>.getElementById( <span class="string">"overview"</span> );</span><br><span class="line">api.goto( overview );   <span class="comment">//HTMLElement</span></span><br></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>impress.js可以让我们的演示文稿更有新意，结合CSS/JS动画，自己掌控视觉效果，比PowerPoint更加灵活精美，但是会复杂一些，如果想把演示文稿排版得更加好看，还是需要花费一定得时间和精力的。</p>
<p>下面是一些Demo以及在线impress制作工具：<br><a href="http://qti3e.github.io/Imprezi/#/step-1" target="_blank" rel="noopener">Imprezi</a><br><a href="http://www.strut.io/" target="_blank" rel="noopener">Strut - An HTML5 Presentation Editor</a><br><a href="http://sylvainw.github.io/HTML5-Future/#/home" target="_blank" rel="noopener">HTML5 Future : to infinity and beyond!</a><br><a href="http://jasoncosper.com/talks/wcphx/wp201/" target="_blank" rel="noopener">WordPress 201: Performance &amp; Security</a><br><a href="http://scottcheng.github.io/revolutionary-css3/#/title" target="_blank" rel="noopener">The Revolutionary CSS3: a non-technical intro to CSS3</a></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/04/05/front-impressjs/。">https://zkhdev.github.io/2017/04/05/front-impressjs/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[算法笔记 - 数组与单链表快速排序(Java)]]></title>
      <url>/2017/03/27/algorithm-fast-array-single-linked/</url>
      <content type="html"><![CDATA[<p>Java实现数组与单链表快速排序<br><a id="more"></a></p>
<h1 id="数组快速排序"><a href="#数组快速排序" class="headerlink" title="数组快速排序"></a>数组快速排序</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> COUNT = <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ZONE = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        Integer[] array = <span class="keyword">new</span> Integer[COUNT];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;COUNT;i++)&#123;</span><br><span class="line">            array[i] = rand.nextInt(ZONE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">        quickSort(array,<span class="number">0</span>,array.length-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">float</span> time = (endTime - startTime) / <span class="number">1000F</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(time);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(Integer[] array,<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(left&gt;=right) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> i = left;</span><br><span class="line">        <span class="keyword">int</span> j = right;</span><br><span class="line">        <span class="keyword">int</span> key = array[(i+j)/<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">            <span class="keyword">for</span>(;i&lt;j&amp;&amp;array[j]&gt;=key;j--);</span><br><span class="line">            array[i] = array[j];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(;i&lt;j&amp;&amp;array[i]&lt;=key;i++);</span><br><span class="line">            array[j] = array[i];</span><br><span class="line">        &#125;</span><br><span class="line">        array[i] = key;</span><br><span class="line">        quickSort(array,left,i-<span class="number">1</span>);</span><br><span class="line">        quickSort(array,i+<span class="number">1</span>,right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="单链表快速排序"><a href="#单链表快速排序" class="headerlink" title="单链表快速排序"></a>单链表快速排序</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedQuickSort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> COUNT = <span class="number">100000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ZONE = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        Node node = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        Node head = node;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;COUNT;i++)&#123;</span><br><span class="line">            node.next = <span class="keyword">new</span> Node(rand.nextInt(ZONE));</span><br><span class="line">            node = node.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">        quickSort(head.next);</span><br><span class="line">        <span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">float</span> time = (endTime - startTime) / <span class="number">1000F</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(time);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(head=head.next;head!=<span class="keyword">null</span>;head=head.next)&#123;</span><br><span class="line">            System.out.print(head.val+<span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title">quickSort</span><span class="params">(Node head)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">        Node left = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        Node middle = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        Node right = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        Node leftHead = left;</span><br><span class="line">        Node middleHead = middle;</span><br><span class="line">        Node rightHead = right;</span><br><span class="line">        <span class="keyword">int</span> val = head.val;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(;head!=<span class="keyword">null</span>;head=head.next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(head.val&lt;val)&#123;</span><br><span class="line">                left.next = head;</span><br><span class="line">                left = left.next;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(head.val&gt;val)&#123;</span><br><span class="line">                right.next = head;</span><br><span class="line">                right = right.next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                middle.next = head;</span><br><span class="line">                middle = middle.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        left.next = <span class="keyword">null</span>;</span><br><span class="line">        middle.next = <span class="keyword">null</span>;</span><br><span class="line">        right.next = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> merge(quickSort(leftHead.next),middleHead.next,quickSort(rightHead.next));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title">merge</span><span class="params">(Node left, Node middle, Node right)</span> </span>&#123;</span><br><span class="line">        Node leftTail = findTail(left);</span><br><span class="line">        Node middleTail = findTail(middle);</span><br><span class="line">        middleTail.next = right;</span><br><span class="line">        <span class="keyword">if</span>(left!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            leftTail.next = middle;</span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> middle;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title">findTail</span><span class="params">(Node node)</span></span>&#123;</span><br><span class="line">        Node tail = node;</span><br><span class="line">        <span class="keyword">if</span>(tail != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(tail.next!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                tail = tail.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tail;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    Node next;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.val = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/27/algorithm-fast-array-single-linked/。">https://zkhdev.github.io/2017/03/27/algorithm-fast-array-single-linked/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 算法 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用Mock.js生成前端测试数据]]></title>
      <url>/2017/03/25/front-mockjs/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-a4fc41caaba25307.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>Mock.js是一个模拟数据生成器，可以让前端独立于后端进行开发。如果你正在开发一个前端页面，可是后台还没有完成供你调用的Api，并且数据格式已经确定，那么你就可以使用Mock.js模拟相关的接口，生成假数据来查看页面效果。Mock.js的功能：生成随机数据，拦截 Ajax 请求。<a id="more"></a></p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><ul>
<li>引入mock.js和JQuery</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"js/jquery-1.12.4.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;script src=<span class="string">"http://mockjs.com/dist/mock.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>创建模拟Api，拦截Ajax请求，返回测试数据</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模拟后台</span></span><br><span class="line">Mock.mock(<span class="string">'http://api.com'</span>, &#123;</span><br><span class="line">    <span class="string">"user|5-10"</span>: [&#123;</span><br><span class="line">        <span class="string">'name'</span>: <span class="string">'@cname'</span>,   <span class="comment">//中文名称</span></span><br><span class="line">        <span class="string">'age|1-100'</span>: <span class="number">100</span>,   <span class="comment">//100以内随机整数</span></span><br><span class="line">        <span class="string">'birthday'</span>: <span class="string">'@date("yyyy-MM-dd")'</span>,  <span class="comment">//日期</span></span><br><span class="line">        <span class="string">'city'</span>: <span class="string">'@city(true)'</span>   <span class="comment">//中国城市</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>发送ajax请求</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JQuery方式</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'http://api.com'</span>,</span><br><span class="line">    dataType: <span class="string">'json'</span></span><br><span class="line">&#125;).done(<span class="function"><span class="keyword">function</span>(<span class="params">data, status, xhr</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">        <span class="built_in">JSON</span>.stringify(data, <span class="literal">null</span>, <span class="number">4</span>)</span><br><span class="line">    )</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原生ajax方式</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myajax</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">            ajax = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                ajax = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ajax = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ajax) &#123;</span><br><span class="line">            <span class="built_in">window</span>.alert(<span class="string">"不能创建XMLHttpRequest对象实例."</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ajax.open(<span class="string">"GET"</span>, url, <span class="literal">true</span>);</span><br><span class="line">        ajax.send(<span class="literal">null</span>);</span><br><span class="line">        ajax.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (ajax.readyState == <span class="number">4</span> &amp;&amp; ajax.status == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(ajax.responseText);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">myajax(<span class="string">'http://api.com'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>查看响应</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"user"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"锺丽"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">17</span>,</span><br><span class="line">            <span class="attr">"birthday"</span>: <span class="string">"1983-11-01"</span>,</span><br><span class="line">            <span class="attr">"city"</span>: <span class="string">"内蒙古自治区 赤峰市"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"陈艳"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">25</span>,</span><br><span class="line">            <span class="attr">"birthday"</span>: <span class="string">"1973-07-10"</span>,</span><br><span class="line">            <span class="attr">"city"</span>: <span class="string">"河南省 驻马店市"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"冯霞"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">59</span>,</span><br><span class="line">            <span class="attr">"birthday"</span>: <span class="string">"2010-10-28"</span>,</span><br><span class="line">            <span class="attr">"city"</span>: <span class="string">"澳门特别行政区 离岛"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"贾秀英"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">63</span>,</span><br><span class="line">            <span class="attr">"birthday"</span>: <span class="string">"1973-01-22"</span>,</span><br><span class="line">            <span class="attr">"city"</span>: <span class="string">"新疆维吾尔自治区 伊犁哈萨克自治州"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"周勇"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">34</span>,</span><br><span class="line">            <span class="attr">"birthday"</span>: <span class="string">"1985-05-21"</span>,</span><br><span class="line">            <span class="attr">"city"</span>: <span class="string">"湖南省 衡阳市"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Mock.js所能做的当然不止这些，可以结合Node、RequireJS等框架进行使用，它包含各种各样的模拟数据，可以自定义相应的规则来生成你想要的模拟数据，可以查看<a href="http://mockjs.com/" target="_blank" rel="noopener">Mock.js官网</a>，了解更多Mock命令。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/25/front-mockjs/。">https://zkhdev.github.io/2017/03/25/front-mockjs/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 前端 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[SSM之整合Redis]]></title>
      <url>/2017/03/22/java-ssm-redis/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-9711235e97aa29b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<a id="more"></a>
<h1 id="Redis安装与使用"><a href="#Redis安装与使用" class="headerlink" title="Redis安装与使用"></a>Redis安装与使用</h1><p>第一步当然是安装Redis，这里以Windows上的安装为例。</p>
<ul>
<li>首先下载<a href="https://github.com/MSOpenTech/redis/releases" target="_blank" rel="noopener">Redis</a>,可以选择msi或zip包安装方式</li>
<li>zip方式需打开cmd窗口，在解压后的目录下运行<code>redis-server redis.windows.conf</code>启动Redis</li>
<li>采用msi方式安装后Redis默认启动，不需要进行任何配置</li>
<li>可以在<strong>redis.windows.conf</strong>文件中修改Redis端口号、密码等配置，修改完成后使用<code>redis-server redis.windows.conf</code>命令重新启动</li>
<li>在Redis安装目录下执行<code>redis-cli -h 127.0.0.1 -p 6379 -a 密码</code>打开Redis操作界面</li>
<li>如果报错<code>(error) ERR operation not permitted</code>，使用<code>auth 密码</code>进行验证</li>
</ul>
<h1 id="SSM整合Redis"><a href="#SSM整合Redis" class="headerlink" title="SSM整合Redis"></a>SSM整合Redis</h1><p>这里直接在上一篇<a href="http://www.jianshu.com/p/b6b1ec6b1816" target="_blank" rel="noopener">SSM之框架整合</a>的基础上进行Redis整合，<strong>这里需要注意，存入Redis的pojo类必须实现<code>Serializable</code>接口</strong>。</p>
<h2 id="配置pom-xml引入Redis依赖"><a href="#配置pom-xml引入Redis依赖" class="headerlink" title="配置pom.xml引入Redis依赖"></a>配置pom.xml引入Redis依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--redis--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="redis-properties"><a href="#redis-properties" class="headerlink" title="redis.properties"></a>redis.properties</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">redis.host=127.0.0.1</span><br><span class="line">redis.port=6379</span><br><span class="line">redis.password=redis</span><br><span class="line">redis.maxIdle=100</span><br><span class="line">redis.maxWait=1000</span><br><span class="line">redis.testOnBorrow=true</span><br><span class="line">redis.timeout=100000</span><br><span class="line">defaultCacheExpireTime=3600</span><br></pre></td></tr></table></figure>
<h2 id="applicationContext-redis-xml"><a href="#applicationContext-redis-xml" class="headerlink" title="applicationContext-redis.xml"></a>applicationContext-redis.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入Redis配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"propertyConfigurer"</span> <span class="attr">class</span>=<span class="string">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"locations"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:redis.properties<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- jedis 连接池配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"poolConfig"</span> <span class="attr">class</span>=<span class="string">"redis.clients.jedis.JedisPoolConfig"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.maxIdle&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxWaitMillis"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.maxWait&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnBorrow"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.testOnBorrow&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- redis连接工厂 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"connectionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolConfig"</span> <span class="attr">ref</span>=<span class="string">"poolConfig"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"port"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.port&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hostName"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.host&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.password&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeout"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis.timeout&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.core.RedisTemplate"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"connectionFactory"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"keySerializer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"valueSerializer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.JdkSerializationRedisSerializer"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 缓存拦截器配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"methodCacheInterceptor"</span> <span class="attr">class</span>=<span class="string">"com.zkh.interceptor.MethodCacheInterceptor"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"redisUtil"</span> <span class="attr">ref</span>=<span class="string">"redisUtil"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultCacheExpireTime"</span> <span class="attr">value</span>=<span class="string">"$&#123;defaultCacheExpireTime&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 禁用缓存的类名列表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"targetNamesList"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 禁用缓存的方法名列表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"methodNamesList"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisUtil"</span> <span class="attr">class</span>=<span class="string">"com.zkh.util.RedisUtil"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"redisTemplate"</span> <span class="attr">ref</span>=<span class="string">"redisTemplate"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置切面拦截方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"controllerMethodPointcut"</span> <span class="attr">expression</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">        execution(* com.zkh.service.impl.*.select*(..))"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"methodCacheInterceptor"</span> <span class="attr">pointcut-ref</span>=<span class="string">"controllerMethodPointcut"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="MethodCacheInterceptor-java"><a href="#MethodCacheInterceptor-java" class="headerlink" title="MethodCacheInterceptor.java"></a>MethodCacheInterceptor.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zkh.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zkh.util.RedisUtil;</span><br><span class="line"><span class="keyword">import</span> org.aopalliance.intercept.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.aopalliance.intercept.MethodInvocation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis缓存过滤器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MethodCacheInterceptor</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; targetNamesList; <span class="comment">// 禁用缓存的类名列表</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; methodNamesList; <span class="comment">// 禁用缓存的方法列表</span></span><br><span class="line">    <span class="keyword">private</span> String defaultCacheExpireTime; <span class="comment">// 缓存默认的过期时间</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(MethodInvocation invocation)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Object value = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        String targetName = invocation.getThis().getClass().getName();</span><br><span class="line">        String methodName = invocation.getMethod().getName();</span><br><span class="line">        <span class="keyword">if</span> (!isAddCache(targetName, methodName)) &#123;</span><br><span class="line">            <span class="comment">// 跳过缓存返回结果</span></span><br><span class="line">            <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">        &#125;</span><br><span class="line">        Object[] arguments = invocation.getArguments();</span><br><span class="line">        String key = getCacheKey(targetName, methodName, arguments);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 判断是否有缓存</span></span><br><span class="line">            <span class="keyword">if</span> (redisUtil.exists(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> redisUtil.get(key);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 写入缓存</span></span><br><span class="line">            value = invocation.proceed();</span><br><span class="line">            <span class="keyword">if</span> (value != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">final</span> String tkey = key;</span><br><span class="line">                <span class="keyword">final</span> Object tvalue = value;</span><br><span class="line">                <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        redisUtil.set(tkey, tvalue, Long.parseLong(defaultCacheExpireTime));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).start();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否加入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isAddCache</span><span class="params">(String targetName, String methodName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (targetNamesList.contains(targetName)</span><br><span class="line">                || methodNamesList.contains(methodName) || targetName.contains(<span class="string">"$$EnhancerBySpringCGLIB$$"</span>)) &#123;</span><br><span class="line">            flag = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建缓存key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arguments</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">getCacheKey</span><span class="params">(String targetName, String methodName,</span></span></span><br><span class="line"><span class="function"><span class="params">                               Object[] arguments)</span> </span>&#123;</span><br><span class="line">        StringBuffer sbu = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        sbu.append(targetName).append(<span class="string">"_"</span>).append(methodName);</span><br><span class="line">        <span class="keyword">if</span> ((arguments != <span class="keyword">null</span>) &amp;&amp; (arguments.length != <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arguments.length; i++) &#123;</span><br><span class="line">                sbu.append(<span class="string">"_"</span>).append(arguments[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sbu.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRedisUtil</span><span class="params">(RedisUtil redisUtil)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.redisUtil = redisUtil;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTargetNamesList</span><span class="params">(List&lt;String&gt; targetNamesList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.targetNamesList = targetNamesList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMethodNamesList</span><span class="params">(List&lt;String&gt; methodNamesList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.methodNamesList = methodNamesList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDefaultCacheExpireTime</span><span class="params">(String defaultCacheExpireTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.defaultCacheExpireTime = defaultCacheExpireTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="RedisUtil-java-工具类"><a href="#RedisUtil-java-工具类" class="headerlink" title="RedisUtil.java 工具类"></a>RedisUtil.java 工具类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zkh.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.ValueOperations;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;Serializable, Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 批量删除对应的value</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keys</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">final</span> String... keys)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">            remove(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 批量删除key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pattern</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removePattern</span><span class="params">(<span class="keyword">final</span> String pattern)</span> </span>&#123;</span><br><span class="line">        Set&lt;Serializable&gt; keys = redisTemplate.keys(pattern);</span><br><span class="line">        <span class="keyword">if</span> (keys.size() &gt; <span class="number">0</span>)</span><br><span class="line">            redisTemplate.delete(keys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除对应的value</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">final</span> String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (exists(key)) &#123;</span><br><span class="line">            redisTemplate.delete(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断缓存中是否有对应的value</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">exists</span><span class="params">(<span class="keyword">final</span> String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.hasKey(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(<span class="keyword">final</span> String key)</span> </span>&#123;</span><br><span class="line">        Object result = <span class="keyword">null</span>;</span><br><span class="line">        ValueOperations&lt;Serializable, Object&gt; operations = redisTemplate</span><br><span class="line">                .opsForValue();</span><br><span class="line">        result = operations.get(key);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 写入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(<span class="keyword">final</span> String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> result = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ValueOperations&lt;Serializable, Object&gt; operations = redisTemplate</span><br><span class="line">                    .opsForValue();</span><br><span class="line">            operations.set(key, value);</span><br><span class="line">            result = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 写入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(<span class="keyword">final</span> String key, Object value, Long expireTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> result = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ValueOperations&lt;Serializable, Object&gt; operations = redisTemplate</span><br><span class="line">                    .opsForValue();</span><br><span class="line">            operations.set(key, value);</span><br><span class="line">            redisTemplate.expire(key, expireTime, TimeUnit.SECONDS);</span><br><span class="line">            result = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            RedisTemplate&lt;Serializable, Object&gt; redisTemplate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.redisTemplate = redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h1><p><img src="http://upload-images.jianshu.io/upload_images/5266042-ab1bb869a8ca0452.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>刚开始Redis中没有任何记录，接下来访问一下第一页记录</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-b7dd0e972f21fdba.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>再查看缓存，记录已经存如Redis，并且第一次访问会从Mysql中读取数据</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-9e4aaa797974d4e0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-bd3868f9c894c580.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>按<code>F5</code>刷新页面，从Tomcat控制台可以看到没有进行SQL查询，而是直接从Redis中读取缓存数据，减轻了数据库的负担</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-9afea7303c4588ab.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-5974109c8ee81850.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>具体代码已发布在Github上，地址：<a href="https://github.com/ZKHDEV/SSM" target="_blank" rel="noopener">SSM</a></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/22/java-ssm-redis/。">https://zkhdev.github.io/2017/03/22/java-ssm-redis/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> ssm </tag>
            
            <tag> redis </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[算法笔记 - 单链表反转(Java)]]></title>
      <url>/2017/03/20/algorithm-single-linked-inversion/</url>
      <content type="html"><![CDATA[<p>Java实现单链表反转<br><a id="more"></a><br>单链表反转使用p、q、r三个指针配合工作，使得两个节点间的指向反向，同时用r记录剩下的链表。基本流程如下图所示：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-f6c75291059014f6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReverseList</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">reverseList</span><span class="params">(Node head)</span></span>&#123;</span><br><span class="line">        Node p = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        Node q = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        Node r = <span class="keyword">new</span> Node(<span class="number">0</span>);</span><br><span class="line">        p = head;</span><br><span class="line">        q = head.next;</span><br><span class="line">        p.next = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(q!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            r = q.next;</span><br><span class="line">            q.next = p;</span><br><span class="line">            p = q;</span><br><span class="line">            q = r;</span><br><span class="line">        &#125;</span><br><span class="line">        head = p;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">9</span>;</span><br><span class="line">        Node t = <span class="keyword">new</span> Node(<span class="number">1</span>);</span><br><span class="line">        Node x = t;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= count; i++)&#123;</span><br><span class="line">            x = (x.next = <span class="keyword">new</span> Node(i));</span><br><span class="line">        &#125;</span><br><span class="line">        t = reverseList(t);</span><br><span class="line">        <span class="keyword">while</span>(t!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.print(t.val+<span class="string">" "</span>);</span><br><span class="line">            t = t.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        Node next;</span><br><span class="line">        Node(<span class="keyword">int</span> v)&#123;</span><br><span class="line">            val = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/20/algorithm-single-linked-inversion/。">https://zkhdev.github.io/2017/03/20/algorithm-single-linked-inversion/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 算法 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[SSM之框架整合]]></title>
      <url>/2017/03/18/java-ssm/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-6563f80b1a6dc089.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>SSM框架，即Spring + Spring MVC + MyBatis的整合框架集，是继SSH后比较主流的Java EE企业级框架，采用标准的MVC模式，项目结构与微软的ASP.NET MVC框架非常相似。本文主要结合Intellij IDEA和Maven实现SSM基础框架的搭建与优化。<br><a id="more"></a></p>
<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ul>
<li>jdk-1.8.0</li>
<li>tomcat-8.6.8</li>
<li>maven-3.3.9</li>
<li>Intellij IDEA 2016</li>
</ul>
<h1 id="创建Maven项目"><a href="#创建Maven项目" class="headerlink" title="创建Maven项目"></a>创建Maven项目</h1><p>启动IDEA（IDEA的安装请参考<a href="http://www.jianshu.com/p/fc330021bf02" target="_blank" rel="noopener">IntelliJ IDEA 安装</a>）。<br>点击”Create New Project”创建新项目</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-427fbb941f9aa1fe.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">  </p>
<p>选择右侧的”Maven”，然后配置”Project SDK”为你本机的Java安装目录，接下来填写项目相关信息，创建一个基本的Maven项目</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-03098fb25f03b73d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1446642d3d730760.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-a18be89dc48898e7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>项目创建完成后，点击右下角的”Enable Auto-Import”以自动导入相关依赖</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-94e9f37d31ddbf81.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>接下来须设置项目的Maven设置（每次新建Maven项目都需重新配置），同时按<code>Ctrl</code>+<code>Alt</code>+<code>S</code>打开设置面板，找到Maven配置界面，将”Maven home directory”修改为本机Maven安装目录</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-89b930b3ba76f47f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>一个基本的Maven环境已经搭建完成，下面开始整合SSM框架。</p>
<h1 id="整合SSM框架"><a href="#整合SSM框架" class="headerlink" title="整合SSM框架"></a>整合SSM框架</h1><h2 id="POM-xml"><a href="#POM-xml" class="headerlink" title="POM.xml"></a>POM.xml</h2><p>POM是项目对象模型(Project Object Model)的简称,pom.xml是Maven的核心配置文件。一个Maven项目必须包含pom.xml配置文件，文件中包括了与开发者有关的，缺陷跟踪系统，组织与许可，项目的URL，项目依赖，以及其他与这个项目相关的东西。   </p>
<p>以下是本文项目的pom.xml配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zkh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/ssm<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.6<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.6<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jackson.version</span>&gt;</span>2.9.0.pr1<span class="tag">&lt;/<span class="name">jackson.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- json --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.jackson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core-lgpl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.jackson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-mapper-lgpl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- mail --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.mail<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- log4j --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mchange-commons-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- slf4j --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- spring --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-orm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- SpringMVC --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- validate --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.validation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>validation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0.Alpha1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate.validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0.Alpha1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- servlet --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- el --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.el<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.el-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1-b04<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- jstl --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish.web<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- druid --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.28.odps<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- pagehelper --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--shiro--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>aopalliance<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aopalliance<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>classmate<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.dom4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dom4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.ehcache.modules<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ehcache-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.22.0-CR1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jboss.logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jboss-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="springmvc-xml"><a href="#springmvc-xml" class="headerlink" title="springmvc.xml"></a>springmvc.xml</h2><p>SpringMVC配置文件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 注解驱动、校验器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">validator</span>=<span class="string">"validator"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 视图解析器  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 组件扫描 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.zkh.controller"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 校验器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"validator"</span> <span class="attr">class</span>=<span class="string">"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"providerClass"</span> <span class="attr">value</span>=<span class="string">"org.hibernate.validator.HibernateValidator"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指定校验使用的资源文件，默认使用classpath:ValidationMessages.properties --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationMessageSource"</span> <span class="attr">ref</span>=<span class="string">"messageSource"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 校验错误信息配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"messageSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.context.support.ReloadableResourceBundleMessageSource"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 资源文件名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basenames"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:ValidationMessages<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 资源文件编码格式 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"fileEncodings"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 对资源文件内容缓存时间，单位秒 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cacheSeconds"</span> <span class="attr">value</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 全局异常处理器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.zkh.exception.CustomExceptionResolver"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 文件上传 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 默认编码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 文件大小最大值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"10485760000"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内存中的最大值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxInMemorySize"</span> <span class="attr">value</span>=<span class="string">"40960"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- RESTful下静态资源解析 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;mvc:resources location="/js/" mapping="/js/**"/&gt;</span></span><br><span class="line"><span class="comment">    &lt;mvc:resources location="/img/" mapping="/img/**"/&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 拦截器 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mvc:interceptors&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;mvc:interceptor&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;mvc:mapping path="/**"/&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;mvc:mapping path="/user/**"/&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;bean class="com.zkh.interceptor.LoginInterceptor"&gt;&lt;/bean&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/mvc:interceptor&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/mvc:interceptors&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--避免IE执行AJAX时，返回JSON出现下载文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"mappingJacksonHttpMessageConverter"</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>application/json;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="applicationContext-dao-xml"><a href="#applicationContext-dao-xml" class="headerlink" title="applicationContext-dao.xml"></a>applicationContext-dao.xml</h2><p>数据访问接口层配置文件，包含spring与mybatis的整合配置及数据源配置。这里使用了阿里巴巴的<a href="https://github.com/alibaba/druid" target="_blank" rel="noopener">Druid</a>连接池以及开源的分页插件<a href="https://github.com/pagehelper/Mybatis-PageHelper" target="_blank" rel="noopener">PageHelper</a>，Druid可以说是目前最好的数据库连接池，PageHelper可以简化分页功能开发，关于Druid和PageHelper的完整配置会在后面的文章介绍，当然你也可以使用c3p0连接池代替，配置文件里包含c3p0的配置方式。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入数据库配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--c3p0连接池--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name="driverClass" value="$&#123;jdbc.driver&#125;"&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name="jdbcUrl" value="$&#123;jdbc.url&#125;"&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name="user" value="$&#123;jdbc.username&#125;"&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name="password" value="$&#123;jdbc.password&#125;"&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/bean&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--druid连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.alibaba.druid.pool.DruidDataSource"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 数据库驱动 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 初始化大小、最小、最大连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"initialSize"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minIdle"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 连接等待超时时间，单位是毫秒 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxWait"</span> <span class="attr">value</span>=<span class="string">"60000"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置检测间隔，检测需要关闭的空闲连接 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeBetweenEvictionRunsMillis"</span> <span class="attr">value</span>=<span class="string">"60000"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 一个连接在池中的最小生存时间 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minEvictableIdleTimeMillis"</span> <span class="attr">value</span>=<span class="string">"300000"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationQuery"</span> <span class="attr">value</span>=<span class="string">"SELECT 'x'"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testWhileIdle"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnBorrow"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnReturn"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 打开PSCache，指定每个连接PSCache的大小 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolPreparedStatements"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolPreparedStatementPerConnectionSize"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置监控统计拦截的filters，关闭后监控界面sql无法统计 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"filters"</span> <span class="attr">value</span>=<span class="string">"stat"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--spring和mybatis整合--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis配置文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis/sqlMapConfig.xml"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mapping路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:mapping/*.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"plugins"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--分页插件--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"properties"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                            helperDialect=mysql</span><br><span class="line">                            reasonable=true</span><br><span class="line">                            supportMethodsArguments=true</span><br><span class="line">                            params=count=countSql</span><br><span class="line">                            autoRuntimeDialect=true</span><br><span class="line">                            pageSizeZero=true</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mapper扫描器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.zkh.dao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="sqlMapConfig-xml"><a href="#sqlMapConfig-xml" class="headerlink" title="sqlMapConfig.xml"></a>sqlMapConfig.xml</h2><p>Mybatis配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入数据库配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"jdbc.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 开启延迟加载 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 开启二级缓存 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置类型别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--引入pojo包--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.zkh.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml"></a>web.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">"3.0"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>login.action<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 前端控制器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring/springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.action<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- RESTful前端控制器 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;servlet&gt;</span></span><br><span class="line"><span class="comment">        &lt;servlet-name&gt;springmvc_rest&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</span></span><br><span class="line"><span class="comment">        &lt;init-param&gt;</span></span><br><span class="line"><span class="comment">            &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span></span><br><span class="line"><span class="comment">            &lt;param-value&gt;classpath:spring/springmvc.xml&lt;/param-value&gt;</span></span><br><span class="line"><span class="comment">        &lt;/init-param&gt;</span></span><br><span class="line"><span class="comment">    &lt;/servlet&gt;</span></span><br><span class="line"><span class="comment">    &lt;servlet-mapping&gt;</span></span><br><span class="line"><span class="comment">        &lt;servlet-name&gt;springmvc_rest&lt;/servlet-name&gt;</span></span><br><span class="line"><span class="comment">        &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">    &lt;/servlet-mapping&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 监听器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring/applicationContext-*.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 编码过滤器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Mapper和pojo"><a href="#Mapper和pojo" class="headerlink" title="Mapper和pojo"></a>Mapper和pojo</h2><p>Mapper文件和pojo实体类可以借助”mybatis-generator”自动生成工具生成，关于mybatis-generator的使用请自行Google。</p>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>以上只是一些最核心的配置文件说明，完整代码已发布在Github上，地址在本文末尾，最终项目结构效果如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-3664632aa525c3c0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">  </p>
<h1 id="Tomcat配置"><a href="#Tomcat配置" class="headerlink" title="Tomcat配置"></a>Tomcat配置</h1><p>点击菜单栏Run-&gt;Edit Configurations…</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-89dd2da4b9799ab0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">   </p>
<p>在Run面板左上方添加，选择Tomcat Server-&gt;Local</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-c9dd7505883a75e3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>接下来配置Name(可随意)、Tomcat安装路径、jre安装路径</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-587c78f25fff0483.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>然后打开Deployment标签页，配置使当前项目自动打包并添加到服务器中</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-494e00a0032b1733.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-8be4ec835396e44f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>现在可以运行测试你的WEB项目了，按<code>Shift</code>+<code>F10</code>运行应用，<code>Shift</code>+<code>F9</code>可进行应用调试。</p>
<h1 id="运行效果"><a href="#运行效果" class="headerlink" title="运行效果"></a>运行效果</h1><p><img src="http://upload-images.jianshu.io/upload_images/5266042-c3f390c08454cc05.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-3c9b5c1e23c8139e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-a53e0d71d16b7988.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-e1afbec125e2edcd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-c9efd9a76e9d2e11.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>以上为最基本的SSM整合框架环境搭建，开发过ASP.NET MVC的同学可能会有一种似曾相识的感觉，因为它们真的太像了。之后会向项目中添加一些插件以提高开发效率及应用性能。</p>
<p>具体代码已发布在Github上，地址：<a href="https://github.com/ZKHDEV/SSM" target="_blank" rel="noopener">SSM</a></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/18/java-ssm/。">https://zkhdev.github.io/2017/03/18/java-ssm/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> ssm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Eclipse集成Maven]]></title>
      <url>/2017/03/11/eclipse-maven/</url>
      <content type="html"><![CDATA[<p>Maven项目对象模型(POM)，可以通过一小段描述信息来管理项目的构建，报告和文档的软件项目管理工具，它的目的是通过采用各种模式来创建的一个具有可视性、复用性、可维护性和完整性等特征的开发模式，提高开发效率和产品质量。<br><a id="more"></a><br>关于Maven的具体内容，可以到<a href="http://maven.apache.org/" target="_blank" rel="noopener">Maven官网</a>查看官方文档，网上资料很多，我也不重复造轮子了，本文主要介绍如何在Eclipse中使用Maven。</p>
<h1 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h1><ul>
<li>JAVA-1.8.0</li>
<li>tomcat-8.6.8</li>
<li>maven-3.3.9</li>
<li>Eclipse IDE for Java EE</li>
</ul>
<h1 id="Eclipse集成Maven"><a href="#Eclipse集成Maven" class="headerlink" title="Eclipse集成Maven"></a>Eclipse集成Maven</h1><p>首先需要安装Maven插件，点击菜单栏Help-&gt;Eclipse Marketplace，搜索”maven”，找到”Maven Integration for Eclipse (Luna) 1.5.0”，点击安装。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-65be26ac137095c1?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>接着修改Maven路径，点击Window-&gt;Preferences，展开Maven-&gt;Installations，添加Maven的路径。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-5bd2f4be3b4a4e2b?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><img src="http://upload-images.jianshu.io/upload_images/5266042-e44fc53157f4bb45?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>选择你的Maven安装路径，点击Finish并勾选该项，OK完成。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-e5949d4e5dc57ee3?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>现在已经将Maven集成到Eclipse中了，我们来创建一个基于Maven的网站。</p>
<p>右键点击New-&gt;Other，搜索maven，选择Maven Project然后点两次Next，找到Artifact Id为<strong>maven-archetype-webapp</strong>的项，接着填写pom.xml相关内容，完成。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-891335bf8ca4bafa?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><img src="http://upload-images.jianshu.io/upload_images/5266042-442e46dbe1c8c031?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><img src="http://upload-images.jianshu.io/upload_images/5266042-3e724ce68bd1c28b?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>稍等片刻后可以看到项目结构如下图所示：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-7d5949280f85c5c6?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这不是一个标准的Maven Web项目结构，我们要添加两个源文件夹，名称分别为”src/main/resources”和”src/test/resources”。接着在项目上右击选择Properties来对项目进行一些配置。  </p>
<p>首先选择Project Facets，点击Convert to faceted fro，勾选Dynamic Web Module，版本改为2.3，OK完成。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-7b0b905fd2e800e9?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>再打开Properties面板，选择Deployment Assembly，删除带有test的条目，添加Maven的jar包到WEB-INF/lib下。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-07da5060c834739c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><img src="http://upload-images.jianshu.io/upload_images/5266042-fb5411622e218de4?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><img src="http://upload-images.jianshu.io/upload_images/5266042-cd887038bad24752?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>最终效果如图所示：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-559645f2ef282b01?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>在pom.xml中配置所需的jar包，默认已有单元测试包junit，可以在<a href="http://search.maven.org/" target="_blank" rel="noopener">http://search.maven.org</a>上搜索相应的依赖包，这里先添加两个基本的JavaWeb依赖包”<strong>javax.servlet</strong>“(servlet依赖包)、”<strong>jstl-impl</strong>“(JSP标签库)，再将packaging类型改为war，添加build-&gt;finalName和build-&gt;plugins结点，修改后的pom.xml文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zkh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven_web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>maven_web<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish.web<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>maven_web<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span>  </span><br><span class="line">		  <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">		    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">		    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">		    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">		      <span class="tag">&lt;<span class="name">webResources</span>&gt;</span>  </span><br><span class="line">		        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">		          <span class="tag">&lt;<span class="name">directory</span>&gt;</span>WebContent<span class="tag">&lt;/<span class="name">directory</span>&gt;</span>  </span><br><span class="line">		        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span>  </span><br><span class="line">		      <span class="tag">&lt;/<span class="name">webResources</span>&gt;</span>  </span><br><span class="line">		    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">		  <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样一个基于Maven的WEB项目基本框架就建成了，其它操作和传统开发模式一样，将源代码放在”src/main/java”、”src/test/java”下，相应的配置文件放在src/*/resources下，前端内容放在WEB-INF下，最终项目结构类似下图（采用SSM整合框架）：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-78c669422d6b208b?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/11/eclipse-maven/。">https://zkhdev.github.io/2017/03/11/eclipse-maven/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> elipse </tag>
            
            <tag> maven </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[算法笔记 - Trie树]]></title>
      <url>/2017/03/02/algorithm-trie/</url>
      <content type="html"><![CDATA[<p>Trie树，又称字典树、单词查找树，是一种树形结构，利用字符串的公共前缀来减少查询时间，最大限度地减少无谓地字符串比较，在统计和处理大量数据方面运用广泛，常用于搜索引擎词频统计。<a id="more"></a></p>
<p><img src="http://img.blog.csdn.net/20170302160419258?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvWktIXzEwMQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="Trie"></p>
<p>上图是一棵最基本的字典树，如果将树的根结点到每一个子结点所经过的路径上的字母连起来，就构成了字典中的一个个单词，这棵树就形成了一本字典。每个结点分别包含下一个字母结点的指针，以及从根结点到该结点的路径是否是一个单词的标志，黑色结点表示可构成一个单词，还可包含在建树过程中经过该结点的次数，这个次数用于表示字典中以根结点到该结点所构成的单词为前缀的单词个数。</p>
<p>以英文单词字典树为例，每个结点最多包含26个子结点，因为总共有26个字母（全为小写）。则Trie树的结点可用以下结构体表示：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TrieNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">bool</span> isStr;    <span class="comment">//表示是否能构成单词</span></span><br><span class="line">    <span class="keyword">int</span> l;    <span class="comment">//以根结点到此结点构成的单词为前缀的单词数</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TrieNode</span> *<span class="title">next</span>[26];</span>    <span class="comment">//共26个子节点</span></span><br><span class="line">&#125;Trie;</span><br></pre></td></tr></table></figure>
<p>查询以输入字段为前缀的单词数的实现过程：</p>
<p>首先输入一个正整数n, 表示字典单词数，然后分别输入n个单词来构建字典数，接下来输入一个正整数m，表示要查找的次数，并依次输入要查询的前缀，程序会输出以各个字段为前缀的单词数量。</p>
<p>以下是程序代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 26</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TrieNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">bool</span> isStr;</span><br><span class="line">    <span class="keyword">int</span> l;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TrieNode</span> *<span class="title">next</span>[<span class="title">MAX</span>];</span></span><br><span class="line">&#125;Trie;</span><br><span class="line"></span><br><span class="line"><span class="comment">//向树中插入单词</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(Trie *root,<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root==<span class="literal">NULL</span> || *s==<span class="string">'\0'</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    Trie *p = root;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(*s!=<span class="string">'\0'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;next[*s-<span class="string">'a'</span>]==<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Trie *temp = (Trie *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Trie));</span><br><span class="line">            temp-&gt;isStr = <span class="literal">false</span>;</span><br><span class="line">            temp-&gt;l=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;MAX;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                temp-&gt;next[i] = <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            p-&gt;next[*s-<span class="string">'a'</span>] = temp;</span><br><span class="line">            p=p-&gt;next[*s-<span class="string">'a'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            p=p-&gt;next[*s-<span class="string">'a'</span>];</span><br><span class="line">            p-&gt;l++;</span><br><span class="line">        &#125;</span><br><span class="line">        s++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p-&gt;isStr = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询指定前缀单词树</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(Trie *root,<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Trie *p = root;</span><br><span class="line">    <span class="keyword">while</span>(p!=<span class="literal">NULL</span>&amp;&amp;*s!=<span class="string">'\0'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p=p-&gt;next[*s-<span class="string">'a'</span>];</span><br><span class="line">        s++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p==<span class="literal">NULL</span> ? <span class="number">0</span> : p-&gt;l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除整棵树并释放空间</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(Trie *root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Trie *p = root;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;MAX;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;next[i]!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            del(p-&gt;next[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;  <span class="comment">//字典中单词树</span></span><br><span class="line">    <span class="keyword">int</span> m;  <span class="comment">//查询数目</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> word[<span class="number">100</span>]; <span class="comment">//单词缓冲区</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化字典树</span></span><br><span class="line">    Trie *root = (Trie *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Trie));</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;MAX;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        root-&gt;next[i] = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    root-&gt;isStr=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,word);</span><br><span class="line">        insert(root,word);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">int</span> result[<span class="number">100</span>];    <span class="comment">//查询结果集</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,word);</span><br><span class="line">        result[i] = search(root,word);</span><br><span class="line">    &#125;</span><br><span class="line">    del(root);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出结果</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,result[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    system(<span class="string">"PAUSE"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>样例输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">apple</span><br><span class="line">application</span><br><span class="line">cat</span><br><span class="line">add</span><br><span class="line">catch</span><br><span class="line">5</span><br><span class="line">app</span><br><span class="line">cat</span><br><span class="line">a</span><br><span class="line">add</span><br><span class="line">apple</span><br></pre></td></tr></table></figure>
<p>样例输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">1</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/03/02/algorithm-trie/。">https://zkhdev.github.io/2017/03/02/algorithm-trie/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> 算法 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Ubuntu 安装 SQL Server]]></title>
      <url>/2017/01/23/ubuntu-sqlserver/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-e21da0dcea20d39c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Microsoft Loves Linux"></p>
<p>SQL Server现在可以在Linux上运行了！正如微软CEO Satya Nadella说的，“Microsoft Loves Linux”，既Windows 10内置的Linux子系统和Azure中大量使用Linux系统后，微软全新推出了“SQL Server on Linux”，使SQL Server实现了跨平台运行。最流行的数据库都支持Linux，如MySQL、Oracle Database、PostgreSQL等，MS SQL自然不甘落后。<br><a id="more"></a><br>SQL Server on Linux使用相同的数据库引擎，最新版本为SQL Server vNext CTP 1.1。<br>下面以Ubuntu 16.10下安装SQL Server为例，介绍SQL Server on Linux的安装方法（亲测可用）。</p>
<hr>
<h3 id="1、导入公共存储库GPG密钥（服务器可能不太稳定，如果失败多尝试几次即可）"><a href="#1、导入公共存储库GPG密钥（服务器可能不太稳定，如果失败多尝试几次即可）" class="headerlink" title="1、导入公共存储库GPG密钥（服务器可能不太稳定，如果失败多尝试几次即可）"></a>1、导入公共存储库GPG密钥（服务器可能不太稳定，如果失败多尝试几次即可）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -</span><br></pre></td></tr></table></figure>
<h3 id="2、注册Microsoft-SQL-Server-Ubuntu存储库"><a href="#2、注册Microsoft-SQL-Server-Ubuntu存储库" class="headerlink" title="2、注册Microsoft SQL Server Ubuntu存储库"></a>2、注册Microsoft SQL Server Ubuntu存储库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.microsoft.com/config/ubuntu/16.04/mssql-server.list | sudo tee /etc/apt/sources.list.d/mssql-server.list</span><br></pre></td></tr></table></figure>
<h3 id="3、安装SQL-Server"><a href="#3、安装SQL-Server" class="headerlink" title="3、安装SQL Server"></a>3、安装SQL Server</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y mssql-server</span><br></pre></td></tr></table></figure>
<h3 id="4、设置数据库SA用户密码以及开机自启动"><a href="#4、设置数据库SA用户密码以及开机自启动" class="headerlink" title="4、设置数据库SA用户密码以及开机自启动"></a>4、设置数据库SA用户密码以及开机自启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /opt/mssql/bin/sqlservr-setup</span><br></pre></td></tr></table></figure>
<h3 id="5、查看SQL-Server服务是否启动"><a href="#5、查看SQL-Server服务是否启动" class="headerlink" title="5、查看SQL Server服务是否启动"></a>5、查看SQL Server服务是否启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status mssql-server</span><br></pre></td></tr></table></figure>
<h3 id="6、数据库引擎已经安装好了，还需安装相应的SQL-Server工具来操作数据库"><a href="#6、数据库引擎已经安装好了，还需安装相应的SQL-Server工具来操作数据库" class="headerlink" title="6、数据库引擎已经安装好了，还需安装相应的SQL Server工具来操作数据库"></a>6、数据库引擎已经安装好了，还需安装相应的SQL Server工具来操作数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -</span><br><span class="line">curl https://packages.microsoft.com/config/ubuntu/16.04/prod.list | sudo tee /etc/apt/sources.list.d/msprod.list</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install mssql-tools unixodbc-dev</span><br><span class="line">ln -sfn /opt/mssql-tools/bin/sqlcmd-13.0.1.0 /usr/bin/sqlcmd </span><br><span class="line">ln -sfn /opt/mssql-tools/bin/bcp-13.0.1.0 /usr/bin/bcp</span><br></pre></td></tr></table></figure>
<h3 id="7、测试SQL-Server"><a href="#7、测试SQL-Server" class="headerlink" title="7、测试SQL Server"></a>7、测试SQL Server</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlcmd -S localhost -U SA</span><br></pre></td></tr></table></figure>
<p>输入刚才设置的密码后，进入SQL Server命令行工具模式，输入以下命令查看当前数据库中所有表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT Name from sys.Databases;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>
<p>要连接远程SQL Server，只需将“localhost”修改为远程主机IP，并确保SQL Server侦听端口（默认侦听TCP端口1433）已打开，可在Windows上的SQL Server Management Studio工具连接Linux上的SQL Server实例来进行可视化管理，Linux也有相应的管理工具，在这里不多作介绍。</p>
<p>输入“QUIT”结束当前SQLCMD会话</p>
<hr>
<p>SQL Server on Linux的推出自然是为.NET Core服务的，微软正不断推进旗下产品的开源进程，传统的ASP.NET网站只需稍作修改，就能实现跨平台运行，任何应用都可以通过SQL Server提供高效的服务，SQL Server不仅提供传统的数据存储服务，在企业数据挖掘、数据智能和业务分析等方面的应用是其它数据库满足不了的。将SQL Server开放给Linux对业界来说无疑是一个重磅炸弹，通过“Microsoft Loves Linux”的阐述，微软展现了一个由数据、智能和云计算交织而成的未来愿景。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2017/01/23/ubuntu-sqlserver/。">https://zkhdev.github.io/2017/01/23/ubuntu-sqlserver/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> ubuntu </tag>
            
            <tag> sqlserver </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[开始使用ASP.NET Core - 创建第一个Web应用]]></title>
      <url>/2016/12/09/aspdotnet-core/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-3f7ad7d6e8ef2cb3?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>.NET Core 是.NET Framework的新一代跨平台应用程序开发框架，是微软在一开始发展时就开源的软件平台，由于 .NET Core 的开发目标是跨平台的 .NET 平台，因此 .NET Core 包含 .NET Framework 的类库，但与 .NET Framework 不同的是 .NET Core 所有类库都采用NuGet的管理方式，应用程序只需要获取需要的组件即可，与 .NET Framework 大包式安装的作法截然不同，同时各包亦有独立的版本线 (Version line)，不再硬性要求应用程序跟随主线版本。<br><a id="more"></a><br>ASP.NET Core 以控制台应用程序驱动其托管环境 Kestrel Server 以支持 ASP.NET Core 程序的运行。ASP.NET Core 在开发初期时 .NET Core 还没有开始起跑，在 .NET Core 逐渐成熟之后，微软决定将它们集成在一起，ASP.NET Core的运行期和工具 .NET Core 以及 .NET CLI 接替提供。ASP.NET Core 并不是ASP.NET 4.6的升级版本，它是在.NET Core上重新设计的ASP.NET平台，拥有众多的新特性，其中最重要的特性就是实现了跨平台。ASP.NET Core 1.0是微软新一代ASP.NET框架，之前的版本为ASP.NET 4.6。</p>
<hr>
<p>接下来开始构建第一个ASP.NET Core的Web应用。</p>
<h1 id="搭建开发环境"><a href="#搭建开发环境" class="headerlink" title="搭建开发环境"></a>搭建开发环境</h1><ul>
<li>安装Visual Studio和 .NET Core（核心）</li>
<li>安装Visual Studio Community 2015，如果已安装请跳过这步。<br>  <a href="https://www.visualstudio.com/en-us/visual-studio-homepage-vs.aspx" target="_blank" rel="noopener">Visual Studio 2015 Home page installer</a></li>
<li>安装 .NET Core + Visual Studio tooling<br>  <a href="http://go.microsoft.com/fwlink/?LinkID=798306" target="_blank" rel="noopener">.NET Core + Visual Studio tooling</a></li>
</ul>
<h1 id="创建一个新工程"><a href="#创建一个新工程" class="headerlink" title="创建一个新工程"></a>创建一个新工程</h1><p>新建项目：</p>
<ul>
<li>打开“新建项目”对话框</li>
<li>找到.NET Core下的“ASP.NET Core Web Application (.NET Core)”选项</li>
<li>将项目命名为“CoreMovie”</li>
<li><p>点击“确定”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-551416d83b5c818c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</li>
</ul>
<p>在弹出的对话框中：</p>
<ul>
<li>选择“Web应用程序”</li>
<li>取消勾选“在云中托管”</li>
<li><p>点击“更改身份验证”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-fbf78a72f0fbef60?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</li>
</ul>
<p>选择“个人用户账户”，点击“确定”</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/5266042-8bce2d69caedeb47?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>稍等片刻，Visual Studio会自动搭建工程的脚手架，完成后的项目结构如下：</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/5266042-32f0c8ac53bb8be6?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="添加一个Model类"><a href="#添加一个Model类" class="headerlink" title="添加一个Model类"></a>添加一个Model类</h1><p>右键点击“Models”目录&gt;添加&gt;类</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-0b1cfe8a3d747448?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>创建一个“Movie”类</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-82b183c94fdb23b4?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>在类中添加以下属性：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-561af54a9b768728?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>属性“ID”是必须的，将作为数据表的主键</p>
</blockquote>
<h1 id="构建“控制器”"><a href="#构建“控制器”" class="headerlink" title="构建“控制器”"></a>构建“控制器”</h1><p>右键点击“Controllers”目录&gt;添加&gt;控制器</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-58987f457228c8d0?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>点击“MVC Controller with views, using Entity Framework”，添加</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-58ae66deec8bcdec?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>选择“Movie”模型类和“ApplicationDbContext”数据上下文类，使用默认控制器命名，点击添加</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-0245a9fe3fe07767?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>Visual Studio会自动创建CRUD的相关方法和视图模板。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1ad9e532acdc8927?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="更新数据库"><a href="#更新数据库" class="headerlink" title="更新数据库"></a>更新数据库</h1><p>点击快捷键Ctrl+F5开始调试，在地址栏中输入“<a href="http://localhost:端口号/Movies”，浏览器会提示如下内容：" target="_blank" rel="noopener">http://localhost:端口号/Movies”，浏览器会提示如下内容：</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-54b52ef6108e5887?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这是因为还没有更新数据库，需要通过以下步骤进行更新：</p>
<ul>
<li>打开CMD命令窗口（快捷键Ctrl+R，输入“cmd”，回车）</li>
<li>定位到项目根目录下</li>
<li>输入以下命令完成数据库更新</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-860824b752fdd514?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>DOTNET EF命令</p>
<ul>
<li>dotnet (.NET Core) 是.NET的一个跨平台实现</li>
<li>dotnet ef migrations add Initial 参数“Initial”是任意的，此操作创建的Data/Migrations/_Initial.cs包含迁移文件命令来向数据库添加（或删除）电影表。</li>
<li>dotnet ef database update 使用刚才创建的迁移更新数据库</li>
</ul>
</blockquote>
<h1 id="测试应用程序"><a href="#测试应用程序" class="headerlink" title="测试应用程序"></a>测试应用程序</h1><p>刷新浏览器，可以看到如下页面，点击“Create New”创建新条目</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-b9d00c539e50e372?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-56c85194a87f2adf?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-5d12e8209bfc366c?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>创建完成，一个最基本ASP.NET Core应用程序就创建好了。ASP.NET Core拥有众多提高开发效率的新特性，在接下来的文章中会对部分特性进行介绍。</p>
<p>请尽情享受.NET Core带来的开发快感吧！</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2016/12/09/aspdotnet-core/。">https://zkhdev.github.io/2016/12/09/aspdotnet-core/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> .NET </category>
            
        </categories>
        
        
        <tags>
            
            <tag> .net </tag>
            
            <tag> asp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Ubuntu下Apache开启Rewrite模块]]></title>
      <url>/2016/12/03/ubuntu-apache-rewrite/</url>
      <content type="html"><![CDATA[<p>安装好apache2后默认是没有开启rewrite模块的，需要我们手动进行配置。<br><a id="more"></a><br>在/etc/apache2目录下有几个需要配置的文件和目录：</p>
<ul>
<li><p>mods-available：包含Apache模块及其配置文件</p>
</li>
<li><p>mods-enabled：已开启模块的目录，存放的是已开启模块的<strong>链接</strong>，分别对应/etc/apache2/mods-available目录下的模块，Apache开启时将会加载该目录下链接对应的模块和配置文件</p>
</li>
<li><p>sites-available：包含Apache的虚拟主机配置文件</p>
</li>
<li><p>sites-enabled：对应/etc/apache2/sites-available目录下配置文件的链接，与mods-enabled类似。</p>
</li>
</ul>
<p>开启rewrite模块的方法很简单，在mods-available中可以看到名为rewrite.load的文件，只需执行以下命令就可以加载该模块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod rewrite</span><br></pre></td></tr></table></figure>
<p>然后在 mods-enabled目录下就会生成相应的链接，接着还需要修改Apache的虚拟主机配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apache2/sites-enabled/000-default</span><br></pre></td></tr></table></figure>
<p>将AllowOverride None 修改为 AllowOverride All，如果没有看到这项内容，可以修改apache2.conf配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apache2/apache2.conf</span><br></pre></td></tr></table></figure>
<p>将其中的AllowOverride None 全部替换为 AllowOverride All：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s/AllowOverride None/AllowOverride All</span><br></pre></td></tr></table></figure>
<p>最后重启apache即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/apache2 restart</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2016/12/03/ubuntu-apache-rewrite/。">https://zkhdev.github.io/2016/12/03/ubuntu-apache-rewrite/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> php </tag>
            
            <tag> ubuntu </tag>
            
            <tag> apache </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CentOS 7搭建LAMP环境（二）]]></title>
      <url>/2016/11/20/centos7-lamp2/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-93f8d4c177f01aea?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>前面已经讲过了CentOS 7下LAMP环境的配置过程，一台简单的WEB服务器已搭建完成，但后期在网站部署的过程中也许会碰到各种各样头疼的问题。下面我们来讲讲怎么解决这些问题，以及如何高效地管理服务器和部署网站。<a id="more"></a></p>
<hr>
<h1 id="表单上传文件限制"><a href="#表单上传文件限制" class="headerlink" title="表单上传文件限制"></a>表单上传文件限制</h1><p>为了防止服务器遭到恶意攻击，以及用户上传非法的文件，导致服务器异常和带宽占用，我们必须对用户上传的文件进行过滤，Apache和PHP都默认在这方面进行了限制。那如何修改默认配置呢？接下来给大家讲讲CentOS7+LAMP下（其它LAMP环境的配置过程也类似）上传文件限制的修改过程。</p>
<p>首先，修改PHP的上传文件限制，只需修改php.ini配置文件即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vi /etc/php.ini</span><br></pre></td></tr></table></figure>
<p>根据你的需要修改以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">upload_max_filesize = 允许上传的最大文件大小</span><br><span class="line">post_max_size = 允许post的最大文件大小（一般与上面一项保持一致）</span><br><span class="line">max_file_uploads = 允许单次文件上传个数</span><br><span class="line">upload_tmp_dir = 上传临时文件目录（最好修改为“/var/www/tmp”，方便以后的权限配置）</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：“upload_max_filesize”和“post_max_size”两项都需要进行配置</p>
</blockquote>
<p>然后保存修改，如果修改了临时文件目录，别忘了给指定目录赋权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chmod 777 临时文件目录</span><br></pre></td></tr></table></figure>
<p>接下来，修改Apache的上传文件限制。</p>
<p>在 Fedora 和 Red Hat Enterprise Linux 上默认安装了SELinux，0SELinux是一种基于“域-类型”模型（domain-type）的强制访问控制（MAC）安全系统，它由NSA编写并设计成内核模块包含到内核中，相应的某些安全相关的应用也被打了SELinux的补丁，最后还有一个相应的安全策略。任何程序对其资源享有完全的控制权。假设某个程序打算把含有潜在重要信息的文件扔到/tmp目录下，那么在DAC情况下没人能阻止他。SELinux提供了比传统的UNIX权限更好的访问控制。</p>
<p>为了安全考虑，SELinux会禁止Apache向系统中创建文件，那Apache怎样才能上传文件呢？关闭SELinux可以实现，但不建议这样做，这会大大削弱服务器的安全性。我们可以使用chcon命令修改SELinux安全上下文。修改方式如下：</p>
<ul>
<li>步骤1：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ls –Zd 上传文件目录（如“/var/www/html/upload”）</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>会看到以下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x root root system_u:object_r:httpd_sys_content_t:s0 /var/www/html/upload</span><br></pre></td></tr></table></figure></p>
<ul>
<li>步骤二：使用chcon命令进行修改<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chcon –R –t httpd_sys_content_t_rw /var/www/html/upload</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>步骤三：使用第一步的命令，查看修改结果，如果内容如下则表示修改成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x root root system_u:object_r:httpd_sys_rw_content_t:s0 /var/www/html/upload</span><br></pre></td></tr></table></figure>
</li>
<li><p>步骤四：修改上传文件目录主人和用户组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chown –R apache.apache /var/www/html/upload</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>到此，限制上传文件的配置就结束了，现在你就可以通过表单方式上传文件了，如果还是不能上传，可以通过以下命令查看你上传的文件类型是否被支持，并修改使其支持你的文件类型。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vi /etc/mime.types</span><br></pre></td></tr></table></figure></p>
<h1 id="通过SecureCRT管理服务器"><a href="#通过SecureCRT管理服务器" class="headerlink" title="通过SecureCRT管理服务器"></a>通过SecureCRT管理服务器</h1><p>SecureCRT是一款支持SSH（SSH1和SSH2）的终端仿真程序，简单地说是Windows下登录UNIX或Linux服务器主机的软件。<br>在上一篇文章中已经对CentOS的SSH进行了配置，我们只须在Windows下使用SecureCRT进行连接即可。步骤如下：</p>
<ul>
<li><p>步骤一：下载和安装SecureCRT（请自行谷歌下载安装）</p>
</li>
<li><p>步骤二：打开软件，点击“快速连接”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-496c984b37156607?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</li>
<li><p>步骤三：填写连接服务器信息</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-ea48e76d5f25b3e7?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</li>
</ul>
<blockquote>
<p>注意：这里的用户名须填写在上一篇文章中ssh配置文件里你允许访问的用户名，其它选项默认即可。</p>
</blockquote>
<ul>
<li>步骤四：输入密码，完成连接</li>
</ul>
<p>现在你就可以更便捷地访问你的远程服务器或虚拟机了，SecureCRT还默认提供上传文件的功能，但体验不是很好，下面介绍一种更方便快捷的文件上传方式：FTP文件上传。</p>
<h1 id="使用FTP上传文件"><a href="#使用FTP上传文件" class="headerlink" title="使用FTP上传文件"></a>使用FTP上传文件</h1><p>FTP 是File Transfer Protocol（文件传输协议）的英文简称，用于Internet上的控制文件的双向传输。与大多数Internet服务一样，FTP也是一个客户机/服务器系统。用户通过一个支持FTP协议的客户机程序，连接到在远程主机上的FTP服务器程序。用户通过客户机程序向服务器程序发出命令，服务器程序执行用户所发出的命令，并将执行的结果返回到客户机。<br>首先我们需要在CentOS上安装VSFTP服务器，VSFTP是一个基于GPL发布的类Unix系统上使用的FTP服务器软件，命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># yum –y install vsftp</span><br><span class="line"># systemctl start vsftpd</span><br><span class="line"># systemctl enable vsftpd</span><br></pre></td></tr></table></figure>
<p>接着需要创建一个专门用于ftp上传文件的用户，该用户属于root用户组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># useradd -g root -M -d /var/www/html -s /sbin/nologin 用户名</span><br><span class="line">// 一般以WEB根目录为FTP上传目录，用于部署网站</span><br><span class="line"># passwd 密码</span><br><span class="line"># chown -R 用户名.root /var/www/html</span><br><span class="line">// 将html目录主人修改为指定FTP用户</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：如果html目录中包含表单上传文件目录，需将该目录主人修改为apache，用户组为apache</p>
</blockquote>
<p>配置vsftp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vi /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>
<p>禁用匿名登录，将“anonymous_enable”设为“NO”，保存修改，同样需要使SELinux允许FTP上传文件到服务器，命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># getsebool -a | grep ftp</span><br><span class="line"># setsebool -P ftpd_full_access on</span><br></pre></td></tr></table></figure>
<p>FTP是一个C/S系统，用户机需要从外部访问FTP服务器，所以需要让FTP服务通过防火墙</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># firewall-cmd --permanent --zone=public --add-service=ftp</span><br><span class="line"># firewall-cmd –reload</span><br></pre></td></tr></table></figure>
<p>这样一台FTP服务器就配置好了，可以通过各种FTP客户端软件进行访问，以Windows下的FileZilla为例，只需填写服务器IP、FTP用户名和密码就能成功连接，可以直接用拖拽方式上传/下载服务器文件了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-de5032d6fd0463bc?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>以上是一些CentOS 7的常见问题解决方案以及对服务器的一些优化，都是博主在使用CentOS过程中总结出来的经验，这些内容都是沧海一粟，要想让你的服务器更安全稳定，还需要更多系统运维方面的知识。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2016/11/20/centos7-lamp2/。">https://zkhdev.github.io/2016/11/20/centos7-lamp2/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> PHP </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
            <tag> php </tag>
            
            <tag> lamp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CentOS 7搭建LAMP环境（一）]]></title>
      <url>/2016/11/19/centos7-lamp/</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5266042-93f8d4c177f01aea?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>CentOS是Linux发行版之一，它是来自于Red Hat Enterprise Linux依照开放源代码规定释出的源代码所编译而成。由于出自同样的源代码，因此有些要求高度稳定性的服务器以CentOS替代商业版的Red Hat Enterprise Linux使用。两者的不同，在于CentOS并不包含封闭源代码软件。<a id="more"></a><br>CentOS 7的安装在这里不进行介绍(可自行谷歌)，这篇文章主要介绍CentOS 7 最小化安装下LAMP环境的配置以及常见问题的解决方案。</p>
<hr>
<h1 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h1><p>安装完CentOS7后第一件事情就是配置服务器网络，可以使用ifconfig命令查看当前网络信息，但CentOS7最小化默认是不提供该命令的，我们可以执行以下命令安装ifconfig工具。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum install –y net-tools        //完成后就可以使用ifconfig命令了</span><br></pre></td></tr></table></figure>
<p>现在配置网络，注意需要root用户才能修改配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># cd /etc/sysconfig/network-scripts/</span><br><span class="line"># cp ./ifcfg-enp0s3 ./ifcfg-enp0s3.bak   //修改配置文件前进行备份</span><br><span class="line"># vi ifcfg-enp0s3</span><br></pre></td></tr></table></figure>
<p>然后根据需要进行修改，这里采用默认配置（如果“ONBOOT”为“no”，将其改为“ye”，这样在下次启动服务器时就会自动打开网络服务），配置完成后保存，重启网络服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># service network restart</span><br></pre></td></tr></table></figure>
<h1 id="更新和升级CentOS"><a href="#更新和升级CentOS" class="headerlink" title="更新和升级CentOS"></a>更新和升级CentOS</h1><p>定期的更新升级，安装已有软件的最新版本以及系统安装升级，可以让你的服务器更安全稳定。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum –y update &amp;&amp; yum –y upgrade</span><br></pre></td></tr></table></figure>
<h1 id="修改ssh配置"><a href="#修改ssh配置" class="headerlink" title="修改ssh配置"></a>修改ssh配置</h1><p>CentOS 7 默认允许任何帐号透过ssh登入，为了不让root帐号被黑客暴力入侵，我们必须禁用root 帐号的ssh功能，事实上root也没必要使用ssh登入服务器，因为只要使用su (当然需要输入root的密码) 普通帐号便可以拥有root权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vi /etc/ssh/ssh_config</span><br></pre></td></tr></table></figure>
<p>将“#Protocol 1,2”改为“Protocol 2”，“#PermitRootLogin yes”改为“PermitRootLogin no”，添加“AllowUsers 你的普通账户名”，然后保存，重启ssh服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vi systemctl restart sshd.service</span><br></pre></td></tr></table></figure>
<h1 id="安装Apache-HTTP服务器"><a href="#安装Apache-HTTP服务器" class="headerlink" title="安装Apache HTTP服务器"></a>安装Apache HTTP服务器</h1><p>httpd是Apache服务器的主程序，被设计为一个独立运行的后台进程，它会建立一个处理请求的子进程或线程的池。接下来安装httpd。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum –y install httpd</span><br></pre></td></tr></table></figure>
<p>完成后开启httpd服务，并且让其在重启系统时自启动。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># systemctl start httpd.service</span><br><span class="line"># systemctl enable httpd.service</span><br></pre></td></tr></table></figure>
<p>接着配置防火墙允许服务器被外部访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># firewall-cmd --permanent --add-service=http --add-port=80/tcp</span><br><span class="line">    //apache默认为80端口，如果你修改了默认端口，这里要改为相应端口号</span><br><span class="line"># firewall-cmd –reload</span><br><span class="line"># systemctl restart httpd.service</span><br></pre></td></tr></table></figure>
<h1 id="安装PHP"><a href="#安装PHP" class="headerlink" title="安装PHP"></a>安装PHP</h1><p>PHP是一种通用开源脚本语言，使用广泛，主要适用于Web开发领域。Linux操作系统下安装PHP非常简单，只需执行一下命令即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># yum –y install php</span><br><span class="line"># systemctl restart httpd.service</span><br></pre></td></tr></table></figure>
<h1 id="安装MariaDB数据库"><a href="#安装MariaDB数据库" class="headerlink" title="安装MariaDB数据库"></a>安装MariaDB数据库</h1><p>MariaDB数据库管理系统是MySQL的一个分支，主要由开源社区在维护，采用GPL授权许可。MariaDB的目的是完全兼容MySQL，包括API和命令行，是目前最受关注的MySQL数据库衍生版，也被视为开源数据库MySQL的替代品。在CentOS7下安装MariaDB，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># yum –y install mariadb-server mariadb</span><br><span class="line"># systemctl start mariadb.service</span><br><span class="line"># systemctl enable mariadb.service</span><br><span class="line"># firewall-cmd --add-service=mysql       //允许MariaDB被远程访问</span><br></pre></td></tr></table></figure>
<p>安装完成后记得修改数据库密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># set password for &apos;root&apos;@&apos;localhost&apos; =password(&apos;密码&apos;);</span><br><span class="line"># systemctl restart mariadb.service</span><br></pre></td></tr></table></figure>
<h1 id="安装phpMyAdmin"><a href="#安装phpMyAdmin" class="headerlink" title="安装phpMyAdmin"></a>安装phpMyAdmin</h1><p>phpMyAdmin 是一个以PHP为基础，以Web-Base方式架构在网站主机上的MySQL的数据库管理工具，让管理者可用Web接口管理MySQL数据库。安装方式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum –y install phpmyadmin</span><br></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>到此，CentOS 7 + LAMP环境就搭建完成了，可以将你的PHP网站部署到“/var/www/html”下，这样一台最基本的WEB服务器就搭建好了。当然，部署网站过程中可能会遇到一些问题，比如不能上传文件、上传文件类型大小限制等问题，以及要如何高效便捷地管理你的远程服务器，将在下一篇文章给大家介绍。</p>
<blockquote>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2016/11/19/centos7-lamp/。">https://zkhdev.github.io/2016/11/19/centos7-lamp/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> PHP </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
            <tag> php </tag>
            
            <tag> lamp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Thinkphp使用PHPMailer发送邮件]]></title>
      <url>/2016/09/13/tp-phpmailer/</url>
      <content type="html"><![CDATA[<p>Thinkphp使用PHPMailer发送邮件<br><a id="more"></a><br>第一次使用ThinkPHP编写”找回密码“功能，按照网上的DEMO做完后，试了好几个邮箱都不管用，试了半天终于成功了，以下是我的实现过程：</p>
<hr>
<h1 id="准备PHPMailer"><a href="#准备PHPMailer" class="headerlink" title="准备PHPMailer"></a>准备PHPMailer</h1><p>首先下载PHPMailer扩展，谷歌百度一下就有了。然后将下载的PHPMailer整个文件夹放到ThinkPHP文件夹里面的Vendor目录下。</p>
<h1 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h1><p>向conf.php配置文件中添加以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&apos;THINK_EMAIL&apos; =&gt; array(</span><br><span class="line">        &apos;SMTP_HOST&apos;   =&gt; &apos;smtp.sina.com&apos;, //SMTP服务器</span><br><span class="line">        &apos;SMTP_PORT&apos;   =&gt; &apos;25&apos;, //SMTP服务器端口</span><br><span class="line">        &apos;SMTP_USER&apos;   =&gt; &apos;xxx@sina.com&apos;, //SMTP服务器用户名</span><br><span class="line">        &apos;SMTP_PASS&apos;   =&gt; &apos;password&apos;, //SMTP服务器密码</span><br><span class="line">        &apos;FROM_EMAIL&apos;  =&gt; &apos;xxx@sina.com&apos;, //发件人EMAIL</span><br><span class="line">        &apos;FROM_NAME&apos;   =&gt; &apos;name&apos;, //发件人名称</span><br><span class="line">        &apos;REPLY_EMAIL&apos; =&gt; &apos;&apos;, //回复EMAIL（留空则为发件人EMAIL）</span><br><span class="line">        &apos;REPLY_NAME&apos;  =&gt; &apos;&apos;, //回复名称（留空则为发件人名称）</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>通过对大部分邮箱的测试，最终只有新浪邮箱测试成功，并且邮箱须开启SMTP服务，新浪邮箱SMTP端口为25。</p>
<h1 id="将邮件发送函数放到common-php文件"><a href="#将邮件发送函数放到common-php文件" class="headerlink" title="将邮件发送函数放到common.php文件"></a>将邮件发送函数放到common.php文件</h1><blockquote>
<p>注意：新版ThinkPHP须把common.php改为function.php。</p>
</blockquote>
<p>接着将以下函数添加到到function.php文件中。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 系统邮件发送函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $to    接收邮件者邮箱</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $name  接收邮件者名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $subject 邮件主题 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $body    邮件内容</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $attachment 附件列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> boolean </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">think_send_mail</span><span class="params">($to, $name, $subject = <span class="string">''</span>, $body = <span class="string">''</span>, $attachment = null)</span></span>&#123;</span><br><span class="line">    $config = C(<span class="string">'THINK_EMAIL'</span>);</span><br><span class="line">    vendor(<span class="string">'PHPMailer.class#phpmailer'</span>); <span class="comment">//从PHPMailer目录导class.phpmailer.php类文件</span></span><br><span class="line">    $mail             = <span class="keyword">new</span> \PHPMailer(); <span class="comment">//PHPMailer对象，注意要添加' \ '</span></span><br><span class="line">    $mail-&gt;CharSet    = <span class="string">'UTF-8'</span>; <span class="comment">//设定邮件编码，默认ISO-8859-1，如果发中文此项必须设置，否则乱码</span></span><br><span class="line">    $mail-&gt;IsSMTP();  <span class="comment">// 设定使用SMTP服务</span></span><br><span class="line">    $mail-&gt;SMTPDebug  = <span class="number">0</span>;                     <span class="comment">// 关闭SMTP调试功能</span></span><br><span class="line">                                               <span class="comment">// 1 = errors and messages</span></span><br><span class="line">                                               <span class="comment">// 2 = messages only</span></span><br><span class="line">    $mail-&gt;SMTPAuth   = <span class="keyword">true</span>;                  <span class="comment">// 启用 SMTP 验证功能</span></span><br><span class="line">    $mail-&gt;SMTPSecure = <span class="string">'tls'</span>;                 <span class="comment">// 使用安全协议，新浪邮箱使用'tls'安全协议，有些邮箱为'ssl'协议</span></span><br><span class="line">    $mail-&gt;Host       = $config[<span class="string">'SMTP_HOST'</span>];  <span class="comment">// SMTP 服务器</span></span><br><span class="line">    $mail-&gt;Port       = $config[<span class="string">'SMTP_PORT'</span>];  <span class="comment">// SMTP服务器的端口号</span></span><br><span class="line">    $mail-&gt;Username   = $config[<span class="string">'SMTP_USER'</span>];  <span class="comment">// SMTP服务器用户名</span></span><br><span class="line">    $mail-&gt;Password   = $config[<span class="string">'SMTP_PASS'</span>];  <span class="comment">// SMTP服务器密码</span></span><br><span class="line">    $mail-&gt;SetFrom($config[<span class="string">'FROM_EMAIL'</span>], $config[<span class="string">'FROM_NAME'</span>]);</span><br><span class="line">    $replyEmail       = $config[<span class="string">'REPLY_EMAIL'</span>]?$config[<span class="string">'REPLY_EMAIL'</span>]:$config[<span class="string">'FROM_EMAIL'</span>];</span><br><span class="line">    $replyName        = $config[<span class="string">'REPLY_NAME'</span>]?$config[<span class="string">'REPLY_NAME'</span>]:$config[<span class="string">'FROM_NAME'</span>];</span><br><span class="line">    $mail-&gt;AddReplyTo($replyEmail, $replyName);</span><br><span class="line">    $mail-&gt;Subject    = $subject;</span><br><span class="line">    $mail-&gt;AltBody    = <span class="string">"为了查看该邮件，请切换到支持 HTML 的邮件客户端"</span>; </span><br><span class="line">    $mail-&gt;MsgHTML($body);</span><br><span class="line">    $mail-&gt;AddAddress($to, $name);</span><br><span class="line">    <span class="keyword">if</span>(is_array($attachment))&#123; <span class="comment">// 添加附件</span></span><br><span class="line">        <span class="keyword">foreach</span> ($attachment <span class="keyword">as</span> $file)&#123;</span><br><span class="line">            is_file($file) &amp;&amp; $mail-&gt;AddAttachment($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>  $mail-&gt;Send() ? <span class="keyword">true</span> : $mail-&gt;ErrorInfo;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h1 id="使用该函数发送邮件"><a href="#使用该函数发送邮件" class="headerlink" title="使用该函数发送邮件"></a>使用该函数发送邮件</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$r = think_send_mail(<span class="string">'要发送的邮箱'</span>,<span class="string">'发送人名称，即你的名称'</span>,<span class="string">'文件标题'</span>,<span class="string">'邮件内容'</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：如果使用phpmailer发送邮件时报错，请尝试以下步骤：</p>
<ol>
<li>修改php.ini，去掉extension=php_openssl.dll前面的分号</li>
<li>修改php.ini，将allow_url_fopen = Off 改为 allow_url_fopen = On</li>
</ol>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2016/09/13/tp-phpmailer/。">https://zkhdev.github.io/2016/09/13/tp-phpmailer/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> PHP </category>
            
        </categories>
        
        
        <tags>
            
            <tag> php </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[VS2015 + EF6连接MYSQL]]></title>
      <url>/2016/09/12/vs-ef-mysql/</url>
      <content type="html"><![CDATA[<p>ADO.NET Entity Framework 是微软以 ADO.NET 为基础所发展出来的对象关系对应 (O/R Mapping) 解决方案，不仅支持SQL Server，还支持MySQL、Oracle等数据库。<br><a id="more"></a><br>接下来给大家讲解EF6+MYSQL具体的配置流程，以及配置过程中一些常见错误的解决方法。</p>
<blockquote>
<p>开发环境：Win10 + VS2015<br>数据库：MySQL 5.7.11</p>
</blockquote>
<hr>
<h1 id="下载并安装插件"><a href="#下载并安装插件" class="headerlink" title="下载并安装插件"></a>下载并安装插件</h1><ul>
<li>MySQL-Connector-net-6.9.9 <a href="http://dev.mysql.com/downloads/connector/net/" target="_blank" rel="noopener">下载</a></li>
<li>MySQL for Visual Studio <a href="http://dev.mysql.com/downloads/installer/" target="_blank" rel="noopener">下载</a></li>
</ul>
<blockquote>
<p><strong>注意：</strong>安装<strong>MySQL for Visual Studio</strong>需下载<strong>MySQL Installer</strong>，然后在安装过程中选择MySQL for Visual Studio。</p>
</blockquote>
<hr>
<h1 id="创建新的ASP-NET-MVC空白项目"><a href="#创建新的ASP-NET-MVC空白项目" class="headerlink" title="创建新的ASP.NET MVC空白项目"></a>创建新的ASP.NET MVC空白项目</h1><p>1.创建项目</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-fecf3f08430366cc?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>2.采用Nuget方式安装MySql.Data.Entity</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-9e5c16e4e81b5181?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-b494f76233ced983?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>安装完成后会多出4项引用</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-5d50e1761dd34564?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>3.添加 ADO.NET 实体数据模型</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-90f2f6f7a3c73209?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>4.选择“来自数据库的 EF 设计器”，我这里已建好数据库，所以选择了DBFirst模式</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-54dd708adf1cf95e?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>5.新建连接，选择“更改(C)…”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-545f85b361a6290e?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>6.选择“MySQL DataBase”，填写连接信息</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-4e0ed0bde2ee4f1d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-bc5a031f711c8ea8?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-f68d16ca0ba92e80?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>7.选择需要的表，点击“完成”，然后就大功告成了！</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-23ee6d409df86fd0?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-65b6c25ee9b25a84?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<hr>
<h1 id="使用空EF设计器生成数据库"><a href="#使用空EF设计器生成数据库" class="headerlink" title="使用空EF设计器生成数据库"></a>使用空EF设计器生成数据库</h1><p>1.步骤与上面类似，这里选择“空EF设计器模型”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-f79c06625a9ea34d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>2.添加实体</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-602b942938822c59?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-65820aeefc221dd4?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>3.创建一个新MySQL的数据库</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-4bd3e471bd87b826?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>4.更改模型属性，选择“SSDLTomYsql.tt(VS)”DDL生成模板（这一步很重要，否则后面会出错）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-ea6ce01667511f13?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>5.右击模型设计器，选择“根据模型生成数据库(G)…”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-cc5ec57b6064d2f1?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>6.填写数据库连接信息，这里选择刚刚创建的“test2”数据库</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-921e34a53746f92d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>7.生成数据库脚本</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-30241eb1226f91eb?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>8.将脚本全部复制到数据库中执行</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-72809037dec28652?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>9.大功告成，数据库成功创建！</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-67d1c46b7de6ec1d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<hr>
<h1 id="配置过程中常见错误及解决方案"><a href="#配置过程中常见错误及解决方案" class="headerlink" title="配置过程中常见错误及解决方案"></a>配置过程中常见错误及解决方案</h1><p>1.无法使用实体框架</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-54cf39524328f6f8?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>解决方案：采用NuGet方式安装MySql.Data.Entity，参见第二节第4步</p>
</blockquote>
<p>2.未修改DDL生成模板</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-22a745173fd798de?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>解决方案：修改DDL生成模板，参见第三节第4步</p>
</blockquote>
<p>3.生成模型时错误</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5266042-1755913a020791d0?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>解决方案：在数据库中执行以下命令：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;use &lt;&lt;数据库名称&gt;&gt;;</span><br><span class="line">&gt;set global optimizer_switch='derived_merge=OFF';</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h1 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h1><p>现在你就可以跟使用SQL Server一样使用MySQL了，虽然过程有点复杂，但还是很值得的。</p>
<blockquote>
<p>以上内容是本人结合一些网上教程和自己的配置经验，总结出来的成果，亲测可用。许多人被EF6+MySQL的配置折腾了很久，希望这篇文章可以给各位提供一点帮助，有不足之处欢迎留言！</p>
<p>本文为作者<a href="https://zkhdev.github.io/">kMacro</a>原创，转载请注明来源：<a href="https://zkhdev.github.io/2016/09/12/vs-ef-mysql/。">https://zkhdev.github.io/2016/09/12/vs-ef-mysql/。</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> .NET </category>
            
        </categories>
        
        
        <tags>
            
            <tag> .net </tag>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
